{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\video\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\video\\\\app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _expressSession = _interopRequireDefault(require(\"express-session\"));\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _socket = require(\"socket.io\");\nvar _path = _interopRequireDefault(require(\"path\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nvar mysql = require(\"mysql\");\nvar cors = require(\"cors\");\nvar conn = mysql.createConnection({\n  host: \"175.198.206.137\",\n  port: 3306,\n  user: \"q\",\n  password: \"q\",\n  database: \"follaw\"\n});\nconn.connect(function (err) {\n  if (err) {\n    console.error(\"MySQL 연결 오류\");\n    return;\n  }\n  console.log(\"MySQL에 성공적으로 연결되었습니다.\");\n});\nvar app = (0, _express[\"default\"])();\napp.set(\"port\", process.env.PORT || 3001);\n// app.set(\"views\", __dirname + \"/views\");\napp.set(\"views\", _path[\"default\"].join(__dirname, \"/views\"));\napp.set(\"view engine\", \"pug\");\n// app.use(\"/public\", express.static(__dirname + \"/public\"));\napp.use(\"/public\", _express[\"default\"][\"static\"](_path[\"default\"].join(__dirname, \"/public\")));\napp.use(_express[\"default\"].json());\napp.use(_express[\"default\"].urlencoded({\n  extended: false\n}));\napp.use((0, _expressSession[\"default\"])({\n  resave: false,\n  saveUninitialized: false,\n  //COOKIE_SECRET 환경 변수가 설정되어 있다면 그 값을 사용하고,\n  //설정되어 있지 않다면 \"secret\"이라는 기본값을 사용하여 세션 데이터를 암호화\n  secret: process.env.COOKIE_SECRET || \"secret\",\n  cookie: {\n    //httpOnly: true는 클라이언트에서 세션 쿠키에 접근할 때 JavaScript를 통한 접근을 막는 옵션\n    httpOnly: true,\n    //secure: false는 세션 쿠키를 안전한 연결(HTTPS)을 통해서만 전송해야 하는지 여부를 설정하는 옵션\n    secure: false\n  }\n}));\napp.use(function (req, res, next) {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  next();\n});\nvar corsOptions = {\n  origin: \"http://localhost:3001/videoIndex\",\n  optionsSuccessStatus: 200\n};\napp.use(cors(corsOptions));\nvar ioPath = _path[\"default\"].resolve(__dirname, \"./node_modules/socket.io-client/dist\");\napp.use(\"/socket.io\", _express[\"default\"][\"static\"](ioPath));\napp.get(\"/\", function (req, res) {\n  // TODO: add user\n  return res.render(\"index\");\n});\n\n//************** 화상 시작 **************/\napp.set(\"dummyDb2\", {\n  rooms: new Array()\n});\napp.get(\"/videoIndex\", function (req, res) {\n  // TODO: add user\n  return res.render(\"videoIndex\");\n});\napp.post(\"/videoIndex\", function (req, res) {\n  // TODO: add user\n  return res.render(\"videoIndex\");\n});\napp.post(\"/videoIndex/newRoom\", function (req, res) {\n  var _req$body = req.body,\n    title = _req$body.title,\n    auth = _req$body.auth,\n    user = _req$body.user;\n  var roomId = req.sessionID + Date.now();\n  var totalCount = 0;\n  var _app$get = app.get(\"dummyDb2\"),\n    rooms = _app$get.rooms;\n  if (auth == 0) {\n    totalCount += 1;\n  }\n  console.log(\"app.js / user :\" + user);\n  rooms.push({\n    title: title,\n    roomId: roomId,\n    totalCount: totalCount\n  });\n  console.log(\"app.js / newRoom : \" + rooms);\n  var sql = \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(1, ?, ?, now())\";\n  var value = [title, user];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n  app.get(\"wss\").clients.forEach(function (client) {\n    if (client.location === \"index\" && client.readyState === client.OPEN) client.send(JSON.stringify(rooms));\n  });\n  return res.redirect(\"/video/\".concat(roomId));\n});\napp.get(\"/video/:roomId\", function (req, res) {\n  var user = req.query.user;\n  console.log(\"/video/:roomId  >>> user : \" + user);\n  var _app$get$rooms$find = app.get(\"dummyDb2\").rooms.find(function (room) {\n      return room.roomId === req.params.roomId;\n    }),\n    title = _app$get$rooms$find.title;\n\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\n  console.log(\"app.js/title :\" + title);\n  res.locals.title = title;\n  var targetRoom = app.get(\"dummyDb2\").rooms.find(function (room) {\n    return room.roomId === req.params.roomId;\n  });\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\n  targetRoom.totalCount += 1;\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\n  var sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\n  var value = [user, title];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\n  res.render(\"video\");\n});\napp.post(\"/videoIndex/leave-room\", function (req, res) {\n  var _req$body2 = req.body,\n    title = _req$body2.title,\n    auth = _req$body2.auth;\n  console.log(\"app.js/title :\" + title);\n  console.log(\"app.js/auth :\" + auth);\n  var _app$get2 = app.get(\"dummyDb2\"),\n    rooms = _app$get2.rooms;\n  console.log(rooms);\n  console.log(\"--------------------\");\n\n  // rooms.totalCount += count;\n  // console.log(\"totalCount : \" + totalCount);\n\n  var foundRoom = rooms.find(function (room) {\n    return room.title === title;\n  });\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\n  if (foundRoom) {\n    if (auth == 1) {\n      foundRoom.totalCount -= 1;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    } else if (auth == 0) {\n      foundRoom.totalCount = 0;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    }\n    if (foundRoom.totalCount == 0) {\n      var index = rooms.indexOf(foundRoom);\n      console.log(\"app.js/index : \" + index);\n      if (index !== -1) {\n        rooms.splice(index, 1);\n        var sql = \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\n        var value = [title];\n        conn.query(sql, value, function (err, result, fields) {\n          if (err) throw err;\n          console.log(result);\n        });\n      }\n    }\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\n    console.log(rooms);\n  }\n  return res.render(\"videoIndex\", {\n    rooms: rooms\n  });\n});\n\n//************** 화상 끝 **************/\n\napp.use(function (err, req, res, next) {\n  res.locals.message = err.message;\n  res.locals.error = process.env.NODE_ENV !== \" production\" ? err : {};\n  res.status(err.status || 500).render(\"error\");\n});\nvar expressServer = app.listen(app.get(\"port\"), function () {\n  return console.log(\"Listening on http://localhost:3001\");\n});\n\n// socket\nrequire(\"./socket\")(expressServer, app);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2V4cHJlc3NTZXNzaW9uIiwiX2h0dHAiLCJfc29ja2V0IiwiX3BhdGgiLCJvYmoiLCJfX2VzTW9kdWxlIiwibXlzcWwiLCJjb3JzIiwiY29ubiIsImNyZWF0ZUNvbm5lY3Rpb24iLCJob3N0IiwicG9ydCIsInVzZXIiLCJwYXNzd29yZCIsImRhdGFiYXNlIiwiY29ubmVjdCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImxvZyIsImFwcCIsImV4cHJlc3MiLCJzZXQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVCIsInBhdGgiLCJqb2luIiwiX19kaXJuYW1lIiwidXNlIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInNlc3Npb24iLCJyZXNhdmUiLCJzYXZlVW5pbml0aWFsaXplZCIsInNlY3JldCIsIkNPT0tJRV9TRUNSRVQiLCJjb29raWUiLCJodHRwT25seSIsInNlY3VyZSIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFkZXIiLCJjb3JzT3B0aW9ucyIsIm9yaWdpbiIsIm9wdGlvbnNTdWNjZXNzU3RhdHVzIiwiaW9QYXRoIiwicmVzb2x2ZSIsImdldCIsInJlbmRlciIsInJvb21zIiwiQXJyYXkiLCJwb3N0IiwiX3JlcSRib2R5IiwiYm9keSIsInRpdGxlIiwiYXV0aCIsInJvb21JZCIsInNlc3Npb25JRCIsIkRhdGUiLCJub3ciLCJ0b3RhbENvdW50IiwiX2FwcCRnZXQiLCJwdXNoIiwic3FsIiwidmFsdWUiLCJxdWVyeSIsInJlc3VsdCIsImZpZWxkcyIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwibG9jYXRpb24iLCJyZWFkeVN0YXRlIiwiT1BFTiIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwicmVkaXJlY3QiLCJjb25jYXQiLCJfYXBwJGdldCRyb29tcyRmaW5kIiwiZmluZCIsInJvb20iLCJwYXJhbXMiLCJsb2NhbHMiLCJ0YXJnZXRSb29tIiwiX3JlcSRib2R5MiIsIl9hcHAkZ2V0MiIsImZvdW5kUm9vbSIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsIm1lc3NhZ2UiLCJOT0RFX0VOViIsInN0YXR1cyIsImV4cHJlc3NTZXJ2ZXIiLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6IkQ6XFxGaW5hbF9Qcm9qZWN0XFxzcmNcXHZpZGVvXFwiLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgc2Vzc2lvbiBmcm9tIFwiZXhwcmVzcy1zZXNzaW9uXCI7XHJcbmltcG9ydCBodHRwIGZyb20gXCJodHRwXCI7XHJcbmltcG9ydCB7IFNlcnZlciB9IGZyb20gXCJzb2NrZXQuaW9cIjtcclxuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcclxuY29uc3QgbXlzcWwgPSByZXF1aXJlKFwibXlzcWxcIik7XHJcbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKTtcclxuXHJcbmNvbnN0IGNvbm4gPSBteXNxbC5jcmVhdGVDb25uZWN0aW9uKHtcclxuICBob3N0OiBcIjE3NS4xOTguMjA2LjEzN1wiLFxyXG4gIHBvcnQ6IDMzMDYsXHJcbiAgdXNlcjogXCJxXCIsXHJcbiAgcGFzc3dvcmQ6IFwicVwiLFxyXG4gIGRhdGFiYXNlOiBcImZvbGxhd1wiLFxyXG59KTtcclxuXHJcbmNvbm4uY29ubmVjdCgoZXJyKSA9PiB7XHJcbiAgaWYgKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIk15U1FMIOyXsOqysCDsmKTrpZhcIik7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKFwiTXlTUUzsl5Ag7ISx6rO17KCB7Jy866GcIOyXsOqysOuQmOyXiOyKteuLiOuLpC5cIik7XHJcbn0pO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5hcHAuc2V0KFwicG9ydFwiLCBwcm9jZXNzLmVudi5QT1JUIHx8IDMwMDEpO1xyXG4vLyBhcHAuc2V0KFwidmlld3NcIiwgX19kaXJuYW1lICsgXCIvdmlld3NcIik7XHJcbmFwcC5zZXQoXCJ2aWV3c1wiLCBwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi92aWV3c1wiKSk7XHJcbmFwcC5zZXQoXCJ2aWV3IGVuZ2luZVwiLCBcInB1Z1wiKTtcclxuLy8gYXBwLnVzZShcIi9wdWJsaWNcIiwgZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lICsgXCIvcHVibGljXCIpKTtcclxuYXBwLnVzZShcIi9wdWJsaWNcIiwgZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIvcHVibGljXCIpKSk7XHJcbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpO1xyXG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiBmYWxzZSB9KSk7XHJcbmFwcC51c2UoXHJcbiAgc2Vzc2lvbih7XHJcbiAgICByZXNhdmU6IGZhbHNlLFxyXG4gICAgc2F2ZVVuaW5pdGlhbGl6ZWQ6IGZhbHNlLFxyXG4gICAgLy9DT09LSUVfU0VDUkVUIO2ZmOqyvSDrs4DsiJjqsIAg7ISk7KCV65CY7Ja0IOyeiOuLpOuptCDqt7gg6rCS7J2EIOyCrOyaqe2VmOqzoCxcclxuICAgIC8v7ISk7KCV65CY7Ja0IOyeiOyngCDslYrri6TrqbQgXCJzZWNyZXRcIuydtOudvOuKlCDquLDrs7jqsJLsnYQg7IKs7Jqp7ZWY7JesIOyEuOyFmCDrjbDsnbTthLDrpbwg7JWU7Zi47ZmUXHJcbiAgICBzZWNyZXQ6IHByb2Nlc3MuZW52LkNPT0tJRV9TRUNSRVQgfHwgXCJzZWNyZXRcIixcclxuICAgIGNvb2tpZToge1xyXG4gICAgICAvL2h0dHBPbmx5OiB0cnVl64qUIO2BtOudvOydtOyWuO2KuOyXkOyEnCDshLjshZgg7L+g7YKk7JeQIOygkeq3vO2VoCDrlYwgSmF2YVNjcmlwdOulvCDthrXtlZwg7KCR6re87J2EIOunieuKlCDsmLXshZhcclxuICAgICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICAgIC8vc2VjdXJlOiBmYWxzZeuKlCDshLjshZgg7L+g7YKk66W8IOyViOyghO2VnCDsl7DqsrAoSFRUUFMp7J2EIO2Gte2VtOyEnOunjCDsoITshqHtlbTslbwg7ZWY64qU7KeAIOyXrOu2gOulvCDshKTsoJXtlZjripQg7Ji17IWYXHJcbiAgICAgIHNlY3VyZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gIH0pXHJcbik7XHJcbmFwcC51c2UoKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgcmVzLmhlYWRlcihcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiLCBcIipcIik7XHJcbiAgcmVzLmhlYWRlcihcclxuICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiLFxyXG4gICAgXCJPcmlnaW4sIFgtUmVxdWVzdGVkLVdpdGgsIENvbnRlbnQtVHlwZSwgQWNjZXB0XCJcclxuICApO1xyXG4gIG5leHQoKTtcclxufSk7XHJcblxyXG5jb25zdCBjb3JzT3B0aW9ucyA9IHtcclxuICBvcmlnaW46IFwiaHR0cDovL2xvY2FsaG9zdDozMDAxL3ZpZGVvSW5kZXhcIixcclxuICBvcHRpb25zU3VjY2Vzc1N0YXR1czogMjAwLFxyXG59O1xyXG5cclxuYXBwLnVzZShjb3JzKGNvcnNPcHRpb25zKSk7XHJcblxyXG5jb25zdCBpb1BhdGggPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcIi4vbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvZGlzdFwiKTtcclxuYXBwLnVzZShcIi9zb2NrZXQuaW9cIiwgZXhwcmVzcy5zdGF0aWMoaW9QYXRoKSk7XHJcblxyXG5hcHAuZ2V0KFwiL1wiLCAocmVxLCByZXMpID0+IHtcclxuICAvLyBUT0RPOiBhZGQgdXNlclxyXG4gIHJldHVybiByZXMucmVuZGVyKFwiaW5kZXhcIik7XHJcbn0pO1xyXG5cclxuLy8qKioqKioqKioqKioqKiDtmZTsg4Eg7Iuc7J6RICoqKioqKioqKioqKioqL1xyXG5hcHAuc2V0KFwiZHVtbXlEYjJcIiwgeyByb29tczogbmV3IEFycmF5KCkgfSk7XHJcblxyXG5hcHAuZ2V0KFwiL3ZpZGVvSW5kZXhcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgLy8gVE9ETzogYWRkIHVzZXJcclxuICByZXR1cm4gcmVzLnJlbmRlcihcInZpZGVvSW5kZXhcIik7XHJcbn0pO1xyXG5cclxuYXBwLnBvc3QoXCIvdmlkZW9JbmRleFwiLCAocmVxLCByZXMpID0+IHtcclxuICAvLyBUT0RPOiBhZGQgdXNlclxyXG4gIHJldHVybiByZXMucmVuZGVyKFwidmlkZW9JbmRleFwiKTtcclxufSk7XHJcblxyXG5hcHAucG9zdChcIi92aWRlb0luZGV4L25ld1Jvb21cIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgY29uc3QgeyB0aXRsZSwgYXV0aCwgdXNlciB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgcm9vbUlkID0gcmVxLnNlc3Npb25JRCArIERhdGUubm93KCk7XHJcbiAgbGV0IHRvdGFsQ291bnQgPSAwO1xyXG4gIGNvbnN0IHsgcm9vbXMgfSA9IGFwcC5nZXQoXCJkdW1teURiMlwiKTtcclxuXHJcbiAgaWYgKGF1dGggPT0gMCkge1xyXG4gICAgdG90YWxDb3VudCArPSAxO1xyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMgLyB1c2VyIDpcIiArIHVzZXIpO1xyXG5cclxuICByb29tcy5wdXNoKHsgdGl0bGUsIHJvb21JZCwgdG90YWxDb3VudCB9KTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcyAvIG5ld1Jvb20gOiBcIiArIHJvb21zKTtcclxuXHJcbiAgY29uc3Qgc3FsID1cclxuICAgIFwiSU5TRVJUIElOVE8gY2hhdChjaGF0X3R5cGUsIGNoYXRfdGl0bGUsIHVzZXJfaWQsIGNoYXRfY3JlYXRlZCkgVkFMVUVTKDEsID8sID8sIG5vdygpKVwiO1xyXG4gIGNvbnN0IHZhbHVlID0gW3RpdGxlLCB1c2VyXTtcclxuXHJcbiAgY29ubi5xdWVyeShzcWwsIHZhbHVlLCAoZXJyLCByZXN1bHQsIGZpZWxkcykgPT4ge1xyXG4gICAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTtcclxuXHJcbiAgYXBwLmdldChcIndzc1wiKS5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xyXG4gICAgaWYgKGNsaWVudC5sb2NhdGlvbiA9PT0gXCJpbmRleFwiICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSBjbGllbnQuT1BFTilcclxuICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkocm9vbXMpKTtcclxuICB9KTtcclxuICByZXR1cm4gcmVzLnJlZGlyZWN0KGAvdmlkZW8vJHtyb29tSWR9YCk7XHJcbn0pO1xyXG5cclxuYXBwLmdldChcIi92aWRlby86cm9vbUlkXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgdXNlciB9ID0gcmVxLnF1ZXJ5O1xyXG4gIGNvbnNvbGUubG9nKFwiL3ZpZGVvLzpyb29tSWQgID4+PiB1c2VyIDogXCIgKyB1c2VyKTtcclxuICBjb25zdCB7IHRpdGxlIH0gPSBhcHBcclxuICAgIC5nZXQoXCJkdW1teURiMlwiKVxyXG4gICAgLnJvb21zLmZpbmQoKHJvb20pID0+IHJvb20ucm9vbUlkID09PSByZXEucGFyYW1zLnJvb21JZCk7XHJcblxyXG4gIC8vcmVzLmxvY2Fsc+uKlCDsnZHri7Ug6rCd7LK0KHJlcynsnZgg7IaN7ISx7Jy866GcLCDtlbTri7kg7J2R64u17JeQIOuMgO2VnCDroZzsu6wg67OA7IiY66W8IOyEpOygle2VmOqzoCDsgqzsmqntlaAg7IiYIOyeiOqyjCDtlbTspIxcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy90aXRsZSA6XCIgKyB0aXRsZSk7XHJcbiAgcmVzLmxvY2Fscy50aXRsZSA9IHRpdGxlO1xyXG5cclxuICBjb25zdCB0YXJnZXRSb29tID0gYXBwXHJcbiAgICAuZ2V0KFwiZHVtbXlEYjJcIilcclxuICAgIC5yb29tcy5maW5kKChyb29tKSA9PiByb29tLnJvb21JZCA9PT0gcmVxLnBhcmFtcy5yb29tSWQpO1xyXG5cclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy90YXJnZXRSb29tMSA6XCIgKyB0YXJnZXRSb29tLnRvdGFsQ291bnQpO1xyXG4gIHRhcmdldFJvb20udG90YWxDb3VudCArPSAxO1xyXG5cclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy90YXJnZXRSb29tMiA6XCIgKyB0YXJnZXRSb29tLnRvdGFsQ291bnQpO1xyXG5cclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBjaGF0IFNFVCBsYXd5ZXJfaWQ9PyBXSEVSRSBjaGF0X3RpdGxlID0gP1wiO1xyXG4gIGNvbnN0IHZhbHVlID0gW3VzZXIsIHRpdGxlXTtcclxuXHJcbiAgY29ubi5xdWVyeShzcWwsIHZhbHVlLCAoZXJyLCByZXN1bHQsIGZpZWxkcykgPT4ge1xyXG4gICAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTtcclxuXHJcbiAgLy9jaGF0IO2MjOydvOydhCDroIzrjZTrp4HtlZjsl6wg7ZW064u5IO2MjOydvOyXkOyEnCB0aXRsZSDrs4DsiJjrpbwg7IKs7Jqp7ZWgIOyImCDsnojsnYxcclxuICByZXMucmVuZGVyKFwidmlkZW9cIik7XHJcbn0pO1xyXG5cclxuYXBwLnBvc3QoXCIvdmlkZW9JbmRleC9sZWF2ZS1yb29tXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgdGl0bGUsIGF1dGggfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzL3RpdGxlIDpcIiArIHRpdGxlKTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy9hdXRoIDpcIiArIGF1dGgpO1xyXG4gIGxldCB7IHJvb21zIH0gPSBhcHAuZ2V0KFwiZHVtbXlEYjJcIik7XHJcbiAgY29uc29sZS5sb2cocm9vbXMpO1xyXG4gIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XHJcblxyXG4gIC8vIHJvb21zLnRvdGFsQ291bnQgKz0gY291bnQ7XHJcbiAgLy8gY29uc29sZS5sb2coXCJ0b3RhbENvdW50IDogXCIgKyB0b3RhbENvdW50KTtcclxuXHJcbiAgY29uc3QgZm91bmRSb29tID0gcm9vbXMuZmluZCgocm9vbSkgPT4gcm9vbS50aXRsZSA9PT0gdGl0bGUpO1xyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzL2ZvdW5kUm9vbS50b3RhbENvdW50IDpcIiArIGZvdW5kUm9vbS50b3RhbENvdW50KTtcclxuXHJcbiAgaWYgKGZvdW5kUm9vbSkge1xyXG4gICAgaWYgKGF1dGggPT0gMSkge1xyXG4gICAgICBmb3VuZFJvb20udG90YWxDb3VudCAtPSAxO1xyXG4gICAgICBjb25zb2xlLmxvZyhcImFwcC5qcy90b3RhbENvdW50MTExIDogXCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcbiAgICB9IGVsc2UgaWYgKGF1dGggPT0gMCkge1xyXG4gICAgICBmb3VuZFJvb20udG90YWxDb3VudCA9IDA7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiYXBwLmpzL3RvdGFsQ291bnQxMTEgOiBcIiArIGZvdW5kUm9vbS50b3RhbENvdW50KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZm91bmRSb29tLnRvdGFsQ291bnQgPT0gMCkge1xyXG4gICAgICBjb25zdCBpbmRleCA9IHJvb21zLmluZGV4T2YoZm91bmRSb29tKTtcclxuICAgICAgY29uc29sZS5sb2coXCJhcHAuanMvaW5kZXggOiBcIiArIGluZGV4KTtcclxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgIHJvb21zLnNwbGljZShpbmRleCwgMSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNxbCA9XHJcbiAgICAgICAgICBcIlVQREFURSBjaGF0IFNFVCBjaGF0dGluZ19jbG9zZWQ9bm93KCkgV0hFUkUgY2hhdF90aXRsZSA9ID9cIjtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IFt0aXRsZV07XHJcblxyXG4gICAgICAgIGNvbm4ucXVlcnkoc3FsLCB2YWx1ZSwgKGVyciwgcmVzdWx0LCBmaWVsZHMpID0+IHtcclxuICAgICAgICAgIGlmIChlcnIpIHRocm93IGVycjtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKFwiYXBwLmpzL3RvdGFsQ291bnQyMjIgOiBcIiArIGZvdW5kUm9vbS50b3RhbENvdW50KTtcclxuICAgIGNvbnNvbGUubG9nKHJvb21zKTtcclxuICB9XHJcblxyXG4gIHJldHVybiByZXMucmVuZGVyKFwidmlkZW9JbmRleFwiLCB7IHJvb21zIH0pO1xyXG59KTtcclxuXHJcbi8vKioqKioqKioqKioqKiog7ZmU7IOBIOuBnSAqKioqKioqKioqKioqKi9cclxuXHJcbmFwcC51c2UoKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcclxuICByZXMubG9jYWxzLm1lc3NhZ2UgPSBlcnIubWVzc2FnZTtcclxuICByZXMubG9jYWxzLmVycm9yID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwiIHByb2R1Y3Rpb25cIiA/IGVyciA6IHt9O1xyXG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLnJlbmRlcihcImVycm9yXCIpO1xyXG59KTtcclxuXHJcbmNvbnN0IGV4cHJlc3NTZXJ2ZXIgPSBhcHAubGlzdGVuKGFwcC5nZXQoXCJwb3J0XCIpLCAoKSA9PlxyXG4gIGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gaHR0cDovL2xvY2FsaG9zdDozMDAxYClcclxuKTtcclxuXHJcbi8vIHNvY2tldFxyXG5yZXF1aXJlKFwiLi9zb2NrZXRcIikoZXhwcmVzc1NlcnZlciwgYXBwKTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGVBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLEtBQUEs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","map":{"version":3,"names":["_express","_interopRequireDefault","require","_expressSession","_http","_socket","_path","obj","__esModule","mysql","cors","conn","createConnection","host","port","user","password","database","connect","err","console","error","log","app","express","set","process","env","PORT","path","join","__dirname","use","json","urlencoded","extended","session","resave","saveUninitialized","secret","COOKIE_SECRET","cookie","httpOnly","secure","req","res","next","header","corsOptions","origin","optionsSuccessStatus","ioPath","resolve","get","render","rooms","Array","post","_req$body","body","title","auth","roomId","sessionID","Date","now","totalCount","_app$get","push","sql","value","query","result","fields","clients","forEach","client","location","readyState","OPEN","send","JSON","stringify","redirect","concat","_app$get$rooms$find","find","room","params","locals","targetRoom","_req$body2","_app$get2","foundRoom","index","indexOf","splice","message","NODE_ENV","status","expressServer","listen"],"sourceRoot":"D:\\Final_Project\\src\\video\\","sources":["app.js"],"sourcesContent":["import express from \"express\";\r\nimport session from \"express-session\";\r\nimport http from \"http\";\r\nimport { Server } from \"socket.io\";\r\nimport path from \"path\";\r\nconst mysql = require(\"mysql\");\r\nconst cors = require(\"cors\");\r\n\r\nconst conn = mysql.createConnection({\r\n  host: \"175.198.206.137\",\r\n  port: 3306,\r\n  user: \"q\",\r\n  password: \"q\",\r\n  database: \"follaw\",\r\n});\r\n\r\nconn.connect((err) => {\r\n  if (err) {\r\n    console.error(\"MySQL 연결 오류\");\r\n    return;\r\n  }\r\n  console.log(\"MySQL에 성공적으로 연결되었습니다.\");\r\n});\r\n\r\nconst app = express();\r\napp.set(\"port\", process.env.PORT || 3001);\r\n// app.set(\"views\", __dirname + \"/views\");\r\napp.set(\"views\", path.join(__dirname, \"/views\"));\r\napp.set(\"view engine\", \"pug\");\r\n// app.use(\"/public\", express.static(__dirname + \"/public\"));\r\napp.use(\"/public\", express.static(path.join(__dirname, \"/public\")));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\napp.use(\r\n  session({\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    //COOKIE_SECRET 환경 변수가 설정되어 있다면 그 값을 사용하고,\r\n    //설정되어 있지 않다면 \"secret\"이라는 기본값을 사용하여 세션 데이터를 암호화\r\n    secret: process.env.COOKIE_SECRET || \"secret\",\r\n    cookie: {\r\n      //httpOnly: true는 클라이언트에서 세션 쿠키에 접근할 때 JavaScript를 통한 접근을 막는 옵션\r\n      httpOnly: true,\r\n      //secure: false는 세션 쿠키를 안전한 연결(HTTPS)을 통해서만 전송해야 하는지 여부를 설정하는 옵션\r\n      secure: false,\r\n    },\r\n  })\r\n);\r\napp.use((req, res, next) => {\r\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n  res.header(\r\n    \"Access-Control-Allow-Headers\",\r\n    \"Origin, X-Requested-With, Content-Type, Accept\"\r\n  );\r\n  next();\r\n});\r\n\r\nconst corsOptions = {\r\n  origin: \"http://localhost:3001/videoIndex\",\r\n  optionsSuccessStatus: 200,\r\n};\r\n\r\napp.use(cors(corsOptions));\r\n\r\nconst ioPath = path.resolve(__dirname, \"./node_modules/socket.io-client/dist\");\r\napp.use(\"/socket.io\", express.static(ioPath));\r\n\r\napp.get(\"/\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"index\");\r\n});\r\n\r\n//************** 화상 시작 **************/\r\napp.set(\"dummyDb2\", { rooms: new Array() });\r\n\r\napp.get(\"/videoIndex\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"videoIndex\");\r\n});\r\n\r\napp.post(\"/videoIndex\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"videoIndex\");\r\n});\r\n\r\napp.post(\"/videoIndex/newRoom\", (req, res) => {\r\n  const { title, auth, user } = req.body;\r\n  const roomId = req.sessionID + Date.now();\r\n  let totalCount = 0;\r\n  const { rooms } = app.get(\"dummyDb2\");\r\n\r\n  if (auth == 0) {\r\n    totalCount += 1;\r\n  }\r\n\r\n  console.log(\"app.js / user :\" + user);\r\n\r\n  rooms.push({ title, roomId, totalCount });\r\n  console.log(\"app.js / newRoom : \" + rooms);\r\n\r\n  const sql =\r\n    \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(1, ?, ?, now())\";\r\n  const value = [title, user];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  app.get(\"wss\").clients.forEach((client) => {\r\n    if (client.location === \"index\" && client.readyState === client.OPEN)\r\n      client.send(JSON.stringify(rooms));\r\n  });\r\n  return res.redirect(`/video/${roomId}`);\r\n});\r\n\r\napp.get(\"/video/:roomId\", (req, res) => {\r\n  const { user } = req.query;\r\n  console.log(\"/video/:roomId  >>> user : \" + user);\r\n  const { title } = app\r\n    .get(\"dummyDb2\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\r\n  console.log(\"app.js/title :\" + title);\r\n  res.locals.title = title;\r\n\r\n  const targetRoom = app\r\n    .get(\"dummyDb2\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\r\n  targetRoom.totalCount += 1;\r\n\r\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\r\n\r\n  const sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\r\n  const value = [user, title];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\r\n  res.render(\"video\");\r\n});\r\n\r\napp.post(\"/videoIndex/leave-room\", (req, res) => {\r\n  const { title, auth } = req.body;\r\n  console.log(\"app.js/title :\" + title);\r\n  console.log(\"app.js/auth :\" + auth);\r\n  let { rooms } = app.get(\"dummyDb2\");\r\n  console.log(rooms);\r\n  console.log(\"--------------------\");\r\n\r\n  // rooms.totalCount += count;\r\n  // console.log(\"totalCount : \" + totalCount);\r\n\r\n  const foundRoom = rooms.find((room) => room.title === title);\r\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\r\n\r\n  if (foundRoom) {\r\n    if (auth == 1) {\r\n      foundRoom.totalCount -= 1;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    } else if (auth == 0) {\r\n      foundRoom.totalCount = 0;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    }\r\n\r\n    if (foundRoom.totalCount == 0) {\r\n      const index = rooms.indexOf(foundRoom);\r\n      console.log(\"app.js/index : \" + index);\r\n      if (index !== -1) {\r\n        rooms.splice(index, 1);\r\n\r\n        const sql =\r\n          \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\r\n        const value = [title];\r\n\r\n        conn.query(sql, value, (err, result, fields) => {\r\n          if (err) throw err;\r\n          console.log(result);\r\n        });\r\n      }\r\n    }\r\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\r\n    console.log(rooms);\r\n  }\r\n\r\n  return res.render(\"videoIndex\", { rooms });\r\n});\r\n\r\n//************** 화상 끝 **************/\r\n\r\napp.use((err, req, res, next) => {\r\n  res.locals.message = err.message;\r\n  res.locals.error = process.env.NODE_ENV !== \" production\" ? err : {};\r\n  res.status(err.status || 500).render(\"error\");\r\n});\r\n\r\nconst expressServer = app.listen(app.get(\"port\"), () =>\r\n  console.log(`Listening on http://localhost:3001`)\r\n);\r\n\r\n// socket\r\nrequire(\"./socket\")(expressServer, app);\r\n"],"mappings":"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"}},"mtime":1706255336586},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\video\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\video\\\\socket.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nvar ws = require(\"ws\");\n\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\nmodule.exports = function (server, app) {\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\n  var wss = new ws.Server({\n    server: server\n  });\n  // for sending a rooms data when a new room is created\n  // used at app.post('newroom') on app.js\n  app.set(\"wss\", wss);\n\n  // Backend에서 socket을 사용할 준비 완료\n  wss.on(\"connection\", function (ws, req) {\n    console.log(\"WebSocket connected to: \" + req.url);\n    if (req.url === \"/videoIndex\") {\n      ws.location = \"videoIndex\";\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\n    } else if (req.url.startsWith(\"/video/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      console.log(\"socket >>> ws.location : \" + ws.location);\n      ws.on(\"message\", function (message) {\n        var data = JSON.parse(message);\n        console.log(\"data\");\n        console.log(data);\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        wss.clients.forEach(function (client) {\n          // if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\n          //   const { welcome, enter } = data;\n          //   console.log(\"welcome\");\n          //   console.log(welcome);\n          //   client.send({type: \"enter\", data : welcome});\n          //   // client.send(JSON.stringify({type: \"welcome\"}));\n          // } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\n          //   const { clientName, name } = data;\n          //   console.log(\"clientName\");\n          //   console.log(clientName);\n          //   client.send({type: \"name\", data : clientName});\n          //   // client.send(clientName.toString());\n          // } else if (data.type === \"offer\") {\n          //   const { roomName, offer } = data;\n          //   if (wss.clients.has(roomName)) {\n          //     for (const client of wss.clients.get(roomName)) {\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\n          //         client.send(JSON.stringify({ type: \"offer\", offer }));\n          //       }\n          //     }\n          //   }\n          // } else if (data.type === \"answer\") {\n          //   const { roomName, answer } = data; \n          //   if (wss.clients.has(roomName)) {\n          //     for (const client of wss.clients.get(roomName)) {\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\n          //         client.send(JSON.stringify({ type: \"answer\", answer }));\n          //       }\n          //     }\n          //   }\n          // } else if (data.type === \"ice\") {\n          //   const { roomName, ice } = data;\n          //   if (wss.clients.has(roomName)) {\n          //     for (const client of wss.clients.get(roomName)) {\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\n          //         client.send(JSON.stringify({ type: \"ice\", ice }));\n          //       }\n          //     }\n          //   }\n          // } else \n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"chat\") {\n            var _message = data.message,\n              chat = data.chat;\n            console.log(\"message.toString()\");\n            console.log(_message.toString());\n            // client.send(message.toString());\n            client.send(JSON.stringify(_message));\n          }\n        });\n      });\n    }\n\n    // ws.on(\"message\", (message) => {\n    //   const data = JSON.parse(message);\n    //   console.log(\"data\");\n    //   console.log(data);\n\n    //   //입장했을 떄 변호사 이름 채팅으로 출력 + 의뢰인 이름 화면에 출력\n    //   wss.clients.forEach((client) => {\n    //     if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\n    //       const { welcome, enter } = data;\n    //       client.send({type: \"enter\", data : welcome});\n    //       // client.send(JSON.stringify({type: \"welcome\"}));\n    //     } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\n    //       const { clientName, name } = data;\n    //       client.send({type: \"name\", data : clientName});\n    //       client.send(clientName.toString());\n    //     } else if (data.type === \"offer\") {\n    //       const { roomName, offer } = data;\n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"offer\", offer }));\n    //           }\n    //         }\n    //       }\n    //     } else if (data.type === \"answer\") {\n    //       const { roomName, answer } = data; \n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"answer\", answer }));\n    //           }\n    //         }\n    //       }\n    //     } else if (data.type === \"ice\") {\n    //       const { roomName, ice } = data;\n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"ice\", ice }));\n    //           }\n    //         }\n    //       }\n    //     }\n    //   });\n    // });\n\n    ws.on(\"error\", function (error) {\n      console.error(error);\n      app.locals.message = error.message;\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\n      app.render(\"error\");\n    });\n    ws.on(\"close\", function () {\n      return console.log(\"\".concat(req.url, \" connection close\"));\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3cyIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwic2VydmVyIiwiYXBwIiwid3NzIiwiU2VydmVyIiwic2V0Iiwib24iLCJyZXEiLCJjb25zb2xlIiwibG9nIiwidXJsIiwibG9jYXRpb24iLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldCIsInJvb21zIiwic3RhcnRzV2l0aCIsInNwbGl0IiwibWVzc2FnZSIsImRhdGEiLCJwYXJzZSIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJ0eXBlIiwiY2hhdCIsInRvU3RyaW5nIiwiZXJyb3IiLCJsb2NhbHMiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJyZW5kZXIiLCJjb25jYXQiXSwic291cmNlUm9vdCI6IkQ6XFxGaW5hbF9Qcm9qZWN0XFxzcmNcXHZpZGVvXFwiLCJzb3VyY2VzIjpbInNvY2tldC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB3cyA9IHJlcXVpcmUoXCJ3c1wiKTtcclxuXHJcbi8vbW9kdWxlLmV4cG9ydHMgOiDrqqjrk4jsnYQg64K067O064K064qUIOuNsCDsgqzsmqnrkJjripQg7Yq57IiY7ZWcIOqwneyytFxyXG4vL+uLpOuluCDtjIzsnbzsl5DshJwg7ZW064u5IOuqqOuTiOydhCDqsIDsoLjsmYAg7IKs7JqpIOqwgOuKpShyZXF1aXJlKCkg7J207JqpKVxyXG5tb2R1bGUuZXhwb3J0cyA9IChzZXJ2ZXIsIGFwcCkgPT4ge1xyXG4gIC8vd3Mg66qo65OI7J2YIFNlcnZlciDtgbTrnpjsiqQoV2ViU29ja2V0IOyEnOuyhOulvCDsg53shLHtlZjqs6Ag6rSA66asKeulvCDsgqzsmqntlZjsl6wgV2ViU29ja2V0IOyEnOuyhOulvCDsg53shLHtlZjripQg6rWs66y4XHJcbiAgY29uc3Qgd3NzID0gbmV3IHdzLlNlcnZlcih7IHNlcnZlciB9KTtcclxuICAvLyBmb3Igc2VuZGluZyBhIHJvb21zIGRhdGEgd2hlbiBhIG5ldyByb29tIGlzIGNyZWF0ZWRcclxuICAvLyB1c2VkIGF0IGFwcC5wb3N0KCduZXdyb29tJykgb24gYXBwLmpzXHJcbiAgYXBwLnNldChcIndzc1wiLCB3c3MpO1xyXG5cclxuICAvLyBCYWNrZW5k7JeQ7IScIHNvY2tldOydhCDsgqzsmqntlaAg7KSA67mEIOyZhOujjFxyXG4gIHdzcy5vbihcImNvbm5lY3Rpb25cIiwgKHdzLCByZXEpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiV2ViU29ja2V0IGNvbm5lY3RlZCB0bzogXCIgKyByZXEudXJsKTtcclxuICAgIGlmIChyZXEudXJsID09PSBcIi92aWRlb0luZGV4XCIpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSBcInZpZGVvSW5kZXhcIjtcclxuICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeShhcHAuZ2V0KFwiZHVtbXlEYjJcIikucm9vbXMpKTtcclxuICAgIH0gZWxzZSBpZiAocmVxLnVybC5zdGFydHNXaXRoKFwiL3ZpZGVvL1wiKSkge1xyXG4gICAgICB3cy5sb2NhdGlvbiA9IHJlcS51cmwuc3BsaXQoXCIvXCIpWzJdO1xyXG4gICAgICBjb25zb2xlLmxvZyhcInNvY2tldCA+Pj4gd3MubG9jYXRpb24gOiBcIiArIHdzLmxvY2F0aW9uKTtcclxuICAgICAgd3Mub24oXCJtZXNzYWdlXCIsIChtZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJkYXRhXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIC8vIHNlbmQgbWVzc2FnZSB0byBvcGVuIHNvY2tldHMgaW4gbXkgcm9vbSB3aXRob3V0IG1lXHJcbiAgICAgICAgLy/tgbTrnbzsnbTslrjtirjqsIAg7ZiE7J6sIOuplOyLnOyngOulvCDrs7Trgrgg7YG065287J207Ja47Yq4KHdzKeyZgCDqsJnsp4Ag7JWK6rOgLFxyXG4gICAgICAgIC8v7IOB7YOc6rCAIE9QRU7snbgg6rK97JqwLCDqt7jrpqzqs6Ag6rCZ7J2AIOuwqShsb2NhdGlvbinsl5Ag7J6I64qUIOqyveyasOyXkOunjCDrqZTshLjsp4Ag7KCE7IahXHJcbiAgICAgICAgd3NzLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XHJcbiAgICAgICAgICAvLyBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJiBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uICYmIGRhdGEudHlwZSA9PT0gXCJlbnRlclwiKSB7XHJcbiAgICAgICAgICAvLyAgIGNvbnN0IHsgd2VsY29tZSwgZW50ZXIgfSA9IGRhdGE7XHJcbiAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKFwid2VsY29tZVwiKTtcclxuICAgICAgICAgIC8vICAgY29uc29sZS5sb2cod2VsY29tZSk7XHJcbiAgICAgICAgICAvLyAgIGNsaWVudC5zZW5kKHt0eXBlOiBcImVudGVyXCIsIGRhdGEgOiB3ZWxjb21lfSk7XHJcbiAgICAgICAgICAvLyAgIC8vIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiBcIndlbGNvbWVcIn0pKTtcclxuICAgICAgICAgIC8vIH0gZWxzZSBpZihjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb24gJiYgZGF0YS50eXBlID09PSBcIm5hbWVcIil7XHJcbiAgICAgICAgICAvLyAgIGNvbnN0IHsgY2xpZW50TmFtZSwgbmFtZSB9ID0gZGF0YTtcclxuICAgICAgICAgIC8vICAgY29uc29sZS5sb2coXCJjbGllbnROYW1lXCIpO1xyXG4gICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhjbGllbnROYW1lKTtcclxuICAgICAgICAgIC8vICAgY2xpZW50LnNlbmQoe3R5cGU6IFwibmFtZVwiLCBkYXRhIDogY2xpZW50TmFtZX0pO1xyXG4gICAgICAgICAgLy8gICAvLyBjbGllbnQuc2VuZChjbGllbnROYW1lLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgLy8gfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09IFwib2ZmZXJcIikge1xyXG4gICAgICAgICAgLy8gICBjb25zdCB7IHJvb21OYW1lLCBvZmZlciB9ID0gZGF0YTtcclxuICAgICAgICAgIC8vICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgICAgICAgIC8vICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAgICAgICAvLyAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgICAgICAgIC8vICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcIm9mZmVyXCIsIG9mZmVyIH0pKTtcclxuICAgICAgICAgIC8vICAgICAgIH1cclxuICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAvLyAgIH1cclxuICAgICAgICAgIC8vIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSBcImFuc3dlclwiKSB7XHJcbiAgICAgICAgICAvLyAgIGNvbnN0IHsgcm9vbU5hbWUsIGFuc3dlciB9ID0gZGF0YTsgXHJcbiAgICAgICAgICAvLyAgIGlmICh3c3MuY2xpZW50cy5oYXMocm9vbU5hbWUpKSB7XHJcbiAgICAgICAgICAvLyAgICAgZm9yIChjb25zdCBjbGllbnQgb2Ygd3NzLmNsaWVudHMuZ2V0KHJvb21OYW1lKSkge1xyXG4gICAgICAgICAgLy8gICAgICAgaWYgKGNsaWVudCAhPT0gd3MgJiYgY2xpZW50LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgICAvLyAgICAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJhbnN3ZXJcIiwgYW5zd2VyIH0pKTtcclxuICAgICAgICAgIC8vICAgICAgIH1cclxuICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAvLyAgIH1cclxuICAgICAgICAgIC8vIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSBcImljZVwiKSB7XHJcbiAgICAgICAgICAvLyAgIGNvbnN0IHsgcm9vbU5hbWUsIGljZSB9ID0gZGF0YTtcclxuICAgICAgICAgIC8vICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgICAgICAgIC8vICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAgICAgICAvLyAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgICAgICAgIC8vICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcImljZVwiLCBpY2UgfSkpO1xyXG4gICAgICAgICAgLy8gICAgICAgfVxyXG4gICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgIC8vICAgfVxyXG4gICAgICAgICAgLy8gfSBlbHNlIFxyXG4gICAgICAgICAgaWYgKGNsaWVudCAhPT0gd3MgJiYgY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4gJiYgY2xpZW50LmxvY2F0aW9uID09PSB3cy5sb2NhdGlvbiAmJiBkYXRhLnR5cGUgPT09IFwiY2hhdFwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZSwgY2hhdCB9ID0gZGF0YTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXNzYWdlLnRvU3RyaW5nKClcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIC8vIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gd3Mub24oXCJtZXNzYWdlXCIsIChtZXNzYWdlKSA9PiB7XHJcbiAgICAvLyAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKG1lc3NhZ2UpO1xyXG4gICAgLy8gICBjb25zb2xlLmxvZyhcImRhdGFcIik7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cclxuICAgIC8vICAgLy/snoXsnqXtlojsnYQg65aEIOuzgO2YuOyCrCDsnbTrpoQg7LGE7YyF7Jy866GcIOy2nOugpSArIOydmOuisOyduCDsnbTrpoQg7ZmU66m07JeQIOy2nOugpVxyXG4gICAgLy8gICB3c3MuY2xpZW50cy5mb3JFYWNoKChjbGllbnQpID0+IHtcclxuICAgIC8vICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJiBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uICYmIGRhdGEudHlwZSA9PT0gXCJlbnRlclwiKSB7XHJcbiAgICAvLyAgICAgICBjb25zdCB7IHdlbGNvbWUsIGVudGVyIH0gPSBkYXRhO1xyXG4gICAgLy8gICAgICAgY2xpZW50LnNlbmQoe3R5cGU6IFwiZW50ZXJcIiwgZGF0YSA6IHdlbGNvbWV9KTtcclxuICAgIC8vICAgICAgIC8vIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiBcIndlbGNvbWVcIn0pKTtcclxuICAgIC8vICAgICB9IGVsc2UgaWYoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJiBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uICYmIGRhdGEudHlwZSA9PT0gXCJuYW1lXCIpe1xyXG4gICAgLy8gICAgICAgY29uc3QgeyBjbGllbnROYW1lLCBuYW1lIH0gPSBkYXRhO1xyXG4gICAgLy8gICAgICAgY2xpZW50LnNlbmQoe3R5cGU6IFwibmFtZVwiLCBkYXRhIDogY2xpZW50TmFtZX0pO1xyXG4gICAgLy8gICAgICAgY2xpZW50LnNlbmQoY2xpZW50TmFtZS50b1N0cmluZygpKTtcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gXCJvZmZlclwiKSB7XHJcbiAgICAvLyAgICAgICBjb25zdCB7IHJvb21OYW1lLCBvZmZlciB9ID0gZGF0YTtcclxuICAgIC8vICAgICAgIGlmICh3c3MuY2xpZW50cy5oYXMocm9vbU5hbWUpKSB7XHJcbiAgICAvLyAgICAgICAgIGZvciAoY29uc3QgY2xpZW50IG9mIHdzcy5jbGllbnRzLmdldChyb29tTmFtZSkpIHtcclxuICAgIC8vICAgICAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgIC8vICAgICAgICAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJvZmZlclwiLCBvZmZlciB9KSk7XHJcbiAgICAvLyAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAvLyAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09IFwiYW5zd2VyXCIpIHtcclxuICAgIC8vICAgICAgIGNvbnN0IHsgcm9vbU5hbWUsIGFuc3dlciB9ID0gZGF0YTsgXHJcbiAgICAvLyAgICAgICBpZiAod3NzLmNsaWVudHMuaGFzKHJvb21OYW1lKSkge1xyXG4gICAgLy8gICAgICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAvLyAgICAgICAgICAgaWYgKGNsaWVudCAhPT0gd3MgJiYgY2xpZW50LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBjbGllbnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwiYW5zd2VyXCIsIGFuc3dlciB9KSk7XHJcbiAgICAvLyAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAvLyAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09IFwiaWNlXCIpIHtcclxuICAgIC8vICAgICAgIGNvbnN0IHsgcm9vbU5hbWUsIGljZSB9ID0gZGF0YTtcclxuICAgIC8vICAgICAgIGlmICh3c3MuY2xpZW50cy5oYXMocm9vbU5hbWUpKSB7XHJcbiAgICAvLyAgICAgICAgIGZvciAoY29uc3QgY2xpZW50IG9mIHdzcy5jbGllbnRzLmdldChyb29tTmFtZSkpIHtcclxuICAgIC8vICAgICAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgIC8vICAgICAgICAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJpY2VcIiwgaWNlIH0pKTtcclxuICAgIC8vICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgIH1cclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgIH0pO1xyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgd3Mub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgIGFwcC5sb2NhbHMubWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XHJcbiAgICAgIGFwcC5sb2NhbHMuZXJyb3IgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCIgcHJvZHVjdGlvblwiID8gZXJyb3IgOiB7fTtcclxuICAgICAgYXBwLnJlbmRlcihcImVycm9yXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd3Mub24oXCJjbG9zZVwiLCAoKSA9PiBjb25zb2xlLmxvZyhgJHtyZXEudXJsfSBjb25uZWN0aW9uIGNsb3NlYCkpO1xyXG4gIH0pO1xyXG59O1xyXG4i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","map":{"version":3,"names":["ws","require","module","exports","server","app","wss","Server","set","on","req","console","log","url","location","send","JSON","stringify","get","rooms","startsWith","split","message","data","parse","clients","forEach","client","readyState","OPEN","type","chat","toString","error","locals","process","env","NODE_ENV","render","concat"],"sourceRoot":"D:\\Final_Project\\src\\video\\","sources":["socket.js"],"sourcesContent":["const ws = require(\"ws\");\r\n\r\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\r\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\r\nmodule.exports = (server, app) => {\r\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\r\n  const wss = new ws.Server({ server });\r\n  // for sending a rooms data when a new room is created\r\n  // used at app.post('newroom') on app.js\r\n  app.set(\"wss\", wss);\r\n\r\n  // Backend에서 socket을 사용할 준비 완료\r\n  wss.on(\"connection\", (ws, req) => {\r\n    console.log(\"WebSocket connected to: \" + req.url);\r\n    if (req.url === \"/videoIndex\") {\r\n      ws.location = \"videoIndex\";\r\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\r\n    } else if (req.url.startsWith(\"/video/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      console.log(\"socket >>> ws.location : \" + ws.location);\r\n      ws.on(\"message\", (message) => {\r\n        const data = JSON.parse(message);\r\n        console.log(\"data\");\r\n        console.log(data);\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        wss.clients.forEach((client) => {\r\n          // if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\r\n          //   const { welcome, enter } = data;\r\n          //   console.log(\"welcome\");\r\n          //   console.log(welcome);\r\n          //   client.send({type: \"enter\", data : welcome});\r\n          //   // client.send(JSON.stringify({type: \"welcome\"}));\r\n          // } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\r\n          //   const { clientName, name } = data;\r\n          //   console.log(\"clientName\");\r\n          //   console.log(clientName);\r\n          //   client.send({type: \"name\", data : clientName});\r\n          //   // client.send(clientName.toString());\r\n          // } else if (data.type === \"offer\") {\r\n          //   const { roomName, offer } = data;\r\n          //   if (wss.clients.has(roomName)) {\r\n          //     for (const client of wss.clients.get(roomName)) {\r\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n          //         client.send(JSON.stringify({ type: \"offer\", offer }));\r\n          //       }\r\n          //     }\r\n          //   }\r\n          // } else if (data.type === \"answer\") {\r\n          //   const { roomName, answer } = data; \r\n          //   if (wss.clients.has(roomName)) {\r\n          //     for (const client of wss.clients.get(roomName)) {\r\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n          //         client.send(JSON.stringify({ type: \"answer\", answer }));\r\n          //       }\r\n          //     }\r\n          //   }\r\n          // } else if (data.type === \"ice\") {\r\n          //   const { roomName, ice } = data;\r\n          //   if (wss.clients.has(roomName)) {\r\n          //     for (const client of wss.clients.get(roomName)) {\r\n          //       if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n          //         client.send(JSON.stringify({ type: \"ice\", ice }));\r\n          //       }\r\n          //     }\r\n          //   }\r\n          // } else \r\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"chat\") {\r\n            const { message, chat } = data;\r\n            console.log(\"message.toString()\");\r\n            console.log(message.toString());\r\n            // client.send(message.toString());\r\n            client.send(JSON.stringify(message));\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    // ws.on(\"message\", (message) => {\r\n    //   const data = JSON.parse(message);\r\n    //   console.log(\"data\");\r\n    //   console.log(data);\r\n\r\n    //   //입장했을 떄 변호사 이름 채팅으로 출력 + 의뢰인 이름 화면에 출력\r\n    //   wss.clients.forEach((client) => {\r\n    //     if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\r\n    //       const { welcome, enter } = data;\r\n    //       client.send({type: \"enter\", data : welcome});\r\n    //       // client.send(JSON.stringify({type: \"welcome\"}));\r\n    //     } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\r\n    //       const { clientName, name } = data;\r\n    //       client.send({type: \"name\", data : clientName});\r\n    //       client.send(clientName.toString());\r\n    //     } else if (data.type === \"offer\") {\r\n    //       const { roomName, offer } = data;\r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"offer\", offer }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     } else if (data.type === \"answer\") {\r\n    //       const { roomName, answer } = data; \r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"answer\", answer }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     } else if (data.type === \"ice\") {\r\n    //       const { roomName, ice } = data;\r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"ice\", ice }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     }\r\n    //   });\r\n    // });\r\n\r\n    ws.on(\"error\", (error) => {\r\n      console.error(error);\r\n      app.locals.message = error.message;\r\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\r\n      app.render(\"error\");\r\n    });\r\n\r\n    ws.on(\"close\", () => console.log(`${req.url} connection close`));\r\n  });\r\n};\r\n"],"mappings":"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"}},"mtime":1706247022816},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\video\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\video\\\\socket.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nvar ws = require(\"ws\");\n\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\nmodule.exports = function (server, app) {\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\n  var wss = new ws.Server({\n    server: server\n  });\n  // for sending a rooms data when a new room is created\n  // used at app.post('newroom') on app.js\n  app.set(\"wss\", wss);\n\n  // Backend에서 socket을 사용할 준비 완료\n  wss.on(\"connection\", function (ws, req) {\n    console.log(\"WebSocket connected to: \" + req.url);\n    if (req.url === \"/videoIndex\") {\n      ws.location = \"videoIndex\";\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\n    } else if (req.url.startsWith(\"/video/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      console.log(\"socket >>> ws.location : \" + ws.location);\n      ws.on(\"message\", function (message) {\n        var data = JSON.parse(message);\n        console.log(\"data\");\n        console.log(data);\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        // wss.clients.forEach((client) => {\n        //   if (\n        //     client !== ws &&\n        //     client.readyState === ws.OPEN &&\n        //     client.location === ws.location\n        //   ) {\n        //     client.send(message.toString());\n        //   }\n        // });\n        wss.clients.forEach(function (client) {\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location) {\n            client.send(message.toString());\n          } else if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\n            var welcome = data.welcome,\n              enter = data.enter;\n            console.log(\"welcome\");\n            console.log(welcome);\n            client.send({\n              type: \"enter\",\n              data: welcome\n            });\n            // client.send(JSON.stringify({type: \"welcome\"}));\n          } else if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\") {\n            var clientName = data.clientName,\n              name = data.name;\n            console.log(\"clientName\");\n            console.log(clientName);\n            client.send({\n              type: \"name\",\n              data: clientName\n            });\n            // client.send(clientName.toString());\n          } else if (data.type === \"offer\") {\n            var roomName = data.roomName,\n              offer = data.offer;\n            if (wss.clients.has(roomName)) {\n              var _iterator = _createForOfIteratorHelper(wss.clients.get(roomName)),\n                _step;\n              try {\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                  var _client = _step.value;\n                  if (_client !== ws && _client.readyState === WebSocket.OPEN) {\n                    _client.send(JSON.stringify({\n                      type: \"offer\",\n                      offer: offer\n                    }));\n                  }\n                }\n              } catch (err) {\n                _iterator.e(err);\n              } finally {\n                _iterator.f();\n              }\n            }\n          } else if (data.type === \"answer\") {\n            var _roomName = data.roomName,\n              answer = data.answer;\n            if (wss.clients.has(_roomName)) {\n              var _iterator2 = _createForOfIteratorHelper(wss.clients.get(_roomName)),\n                _step2;\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  var _client2 = _step2.value;\n                  if (_client2 !== ws && _client2.readyState === WebSocket.OPEN) {\n                    _client2.send(JSON.stringify({\n                      type: \"answer\",\n                      answer: answer\n                    }));\n                  }\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n            }\n          } else if (data.type === \"ice\") {\n            var _roomName2 = data.roomName,\n              ice = data.ice;\n            if (wss.clients.has(_roomName2)) {\n              var _iterator3 = _createForOfIteratorHelper(wss.clients.get(_roomName2)),\n                _step3;\n              try {\n                for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                  var _client3 = _step3.value;\n                  if (_client3 !== ws && _client3.readyState === WebSocket.OPEN) {\n                    _client3.send(JSON.stringify({\n                      type: \"ice\",\n                      ice: ice\n                    }));\n                  }\n                }\n              } catch (err) {\n                _iterator3.e(err);\n              } finally {\n                _iterator3.f();\n              }\n            }\n          } else if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"chat\") {\n            var _message = data.message,\n              chat = data.chat;\n            console.log(\"message.toString()\");\n            console.log(_message.toString());\n            // client.send(message.toString());\n            client.send(JSON.stringify({\n              type: \"chat\",\n              message: _message\n            }));\n          }\n        });\n      });\n    }\n\n    // ws.on(\"message\", (message) => {\n    //   const data = JSON.parse(message);\n    //   console.log(\"data\");\n    //   console.log(data);\n\n    //   //입장했을 떄 변호사 이름 채팅으로 출력 + 의뢰인 이름 화면에 출력\n    //   wss.clients.forEach((client) => {\n    //     if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\n    //       const { welcome, enter } = data;\n    //       client.send({type: \"enter\", data : welcome});\n    //       // client.send(JSON.stringify({type: \"welcome\"}));\n    //     } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\n    //       const { clientName, name } = data;\n    //       client.send({type: \"name\", data : clientName});\n    //       client.send(clientName.toString());\n    //     } else if (data.type === \"offer\") {\n    //       const { roomName, offer } = data;\n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"offer\", offer }));\n    //           }\n    //         }\n    //       }\n    //     } else if (data.type === \"answer\") {\n    //       const { roomName, answer } = data;\n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"answer\", answer }));\n    //           }\n    //         }\n    //       }\n    //     } else if (data.type === \"ice\") {\n    //       const { roomName, ice } = data;\n    //       if (wss.clients.has(roomName)) {\n    //         for (const client of wss.clients.get(roomName)) {\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\n    //             client.send(JSON.stringify({ type: \"ice\", ice }));\n    //           }\n    //         }\n    //       }\n    //     }\n    //   });\n    // });\n\n    ws.on(\"error\", function (error) {\n      console.error(error);\n      app.locals.message = error.message;\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\n      app.render(\"error\");\n    });\n    ws.on(\"close\", function () {\n      return console.log(\"\".concat(req.url, \" connection close\"));\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3cyIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwic2VydmVyIiwiYXBwIiwid3NzIiwiU2VydmVyIiwic2V0Iiwib24iLCJyZXEiLCJjb25zb2xlIiwibG9nIiwidXJsIiwibG9jYXRpb24iLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldCIsInJvb21zIiwic3RhcnRzV2l0aCIsInNwbGl0IiwibWVzc2FnZSIsImRhdGEiLCJwYXJzZSIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJ0b1N0cmluZyIsInR5cGUiLCJ3ZWxjb21lIiwiZW50ZXIiLCJjbGllbnROYW1lIiwibmFtZSIsInJvb21OYW1lIiwib2ZmZXIiLCJoYXMiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsIl9zdGVwIiwicyIsIm4iLCJkb25lIiwidmFsdWUiLCJXZWJTb2NrZXQiLCJlcnIiLCJlIiwiZiIsImFuc3dlciIsIl9pdGVyYXRvcjIiLCJfc3RlcDIiLCJpY2UiLCJfaXRlcmF0b3IzIiwiX3N0ZXAzIiwiY2hhdCIsImVycm9yIiwibG9jYWxzIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwicmVuZGVyIiwiY29uY2F0Il0sInNvdXJjZVJvb3QiOiJEOlxcRmluYWxfUHJvamVjdFxcc3JjXFx2aWRlb1xcIiwic291cmNlcyI6WyJzb2NrZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd3MgPSByZXF1aXJlKFwid3NcIik7XHJcblxyXG4vL21vZHVsZS5leHBvcnRzIDog66qo65OI7J2EIOuCtOuztOuCtOuKlCDrjbAg7IKs7Jqp65CY64qUIO2KueyImO2VnCDqsJ3ssrRcclxuLy/ri6Trpbgg7YyM7J287JeQ7IScIO2VtOuLuSDrqqjrk4jsnYQg6rCA7KC47JmAIOyCrOyaqSDqsIDriqUocmVxdWlyZSgpIOydtOyaqSlcclxubW9kdWxlLmV4cG9ydHMgPSAoc2VydmVyLCBhcHApID0+IHtcclxuICAvL3dzIOuqqOuTiOydmCBTZXJ2ZXIg7YG0656Y7IqkKFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY6rOgIOq0gOumrCnrpbwg7IKs7Jqp7ZWY7JesIFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY64qUIOq1rOusuFxyXG4gIGNvbnN0IHdzcyA9IG5ldyB3cy5TZXJ2ZXIoeyBzZXJ2ZXIgfSk7XHJcbiAgLy8gZm9yIHNlbmRpbmcgYSByb29tcyBkYXRhIHdoZW4gYSBuZXcgcm9vbSBpcyBjcmVhdGVkXHJcbiAgLy8gdXNlZCBhdCBhcHAucG9zdCgnbmV3cm9vbScpIG9uIGFwcC5qc1xyXG4gIGFwcC5zZXQoXCJ3c3NcIiwgd3NzKTtcclxuXHJcbiAgLy8gQmFja2VuZOyXkOyEnCBzb2NrZXTsnYQg7IKs7Jqp7ZWgIOykgOu5hCDsmYTro4xcclxuICB3c3Mub24oXCJjb25uZWN0aW9uXCIsICh3cywgcmVxKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIldlYlNvY2tldCBjb25uZWN0ZWQgdG86IFwiICsgcmVxLnVybCk7XHJcbiAgICBpZiAocmVxLnVybCA9PT0gXCIvdmlkZW9JbmRleFwiKSB7XHJcbiAgICAgIHdzLmxvY2F0aW9uID0gXCJ2aWRlb0luZGV4XCI7XHJcbiAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoYXBwLmdldChcImR1bW15RGIyXCIpLnJvb21zKSk7XHJcbiAgICB9IGVsc2UgaWYgKHJlcS51cmwuc3RhcnRzV2l0aChcIi92aWRlby9cIikpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSByZXEudXJsLnNwbGl0KFwiL1wiKVsyXTtcclxuICAgICAgY29uc29sZS5sb2coXCJzb2NrZXQgPj4+IHdzLmxvY2F0aW9uIDogXCIgKyB3cy5sb2NhdGlvbik7XHJcbiAgICAgIHdzLm9uKFwibWVzc2FnZVwiLCAobWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKG1lc3NhZ2UpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZGF0YVwiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAvLyBzZW5kIG1lc3NhZ2UgdG8gb3BlbiBzb2NrZXRzIGluIG15IHJvb20gd2l0aG91dCBtZVxyXG4gICAgICAgIC8v7YG065287J207Ja47Yq46rCAIO2YhOyerCDrqZTsi5zsp4Drpbwg67O064K4IO2BtOudvOydtOyWuO2KuCh3cynsmYAg6rCZ7KeAIOyViuqzoCxcclxuICAgICAgICAvL+yDge2DnOqwgCBPUEVO7J24IOqyveyasCwg6re466as6rOgIOqwmeydgCDrsKkobG9jYXRpb24p7JeQIOyeiOuKlCDqsr3smrDsl5Drp4wg66mU7IS47KeAIOyghOyGoVxyXG4gICAgICAgIC8vIHdzcy5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xyXG4gICAgICAgIC8vICAgaWYgKFxyXG4gICAgICAgIC8vICAgICBjbGllbnQgIT09IHdzICYmXHJcbiAgICAgICAgLy8gICAgIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmXHJcbiAgICAgICAgLy8gICAgIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb25cclxuICAgICAgICAvLyAgICkge1xyXG4gICAgICAgIC8vICAgICBjbGllbnQuc2VuZChtZXNzYWdlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIC8vICAgfVxyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIHdzcy5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBjbGllbnQgIT09IHdzICYmXHJcbiAgICAgICAgICAgIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmXHJcbiAgICAgICAgICAgIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb25cclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBjbGllbnQuc2VuZChtZXNzYWdlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgY2xpZW50ICE9PSB3cyAmJlxyXG4gICAgICAgICAgICBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJlxyXG4gICAgICAgICAgICBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uICYmXHJcbiAgICAgICAgICAgIGRhdGEudHlwZSA9PT0gXCJlbnRlclwiXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgY29uc3QgeyB3ZWxjb21lLCBlbnRlciB9ID0gZGF0YTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWxjb21lXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh3ZWxjb21lKTtcclxuICAgICAgICAgICAgY2xpZW50LnNlbmQoeyB0eXBlOiBcImVudGVyXCIsIGRhdGE6IHdlbGNvbWUgfSk7XHJcbiAgICAgICAgICAgIC8vIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiBcIndlbGNvbWVcIn0pKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgIGNsaWVudCAhPT0gd3MgJiZcclxuICAgICAgICAgICAgY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4gJiZcclxuICAgICAgICAgICAgY2xpZW50LmxvY2F0aW9uID09PSB3cy5sb2NhdGlvbiAmJlxyXG4gICAgICAgICAgICBkYXRhLnR5cGUgPT09IFwibmFtZVwiXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgY29uc3QgeyBjbGllbnROYW1lLCBuYW1lIH0gPSBkYXRhO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNsaWVudE5hbWVcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNsaWVudE5hbWUpO1xyXG4gICAgICAgICAgICBjbGllbnQuc2VuZCh7IHR5cGU6IFwibmFtZVwiLCBkYXRhOiBjbGllbnROYW1lIH0pO1xyXG4gICAgICAgICAgICAvLyBjbGllbnQuc2VuZChjbGllbnROYW1lLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09IFwib2ZmZXJcIikge1xyXG4gICAgICAgICAgICBjb25zdCB7IHJvb21OYW1lLCBvZmZlciB9ID0gZGF0YTtcclxuICAgICAgICAgICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgICAgICAgICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcIm9mZmVyXCIsIG9mZmVyIH0pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSBcImFuc3dlclwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgcm9vbU5hbWUsIGFuc3dlciB9ID0gZGF0YTtcclxuICAgICAgICAgICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xpZW50ICE9PSB3cyAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcclxuICAgICAgICAgICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcImFuc3dlclwiLCBhbnN3ZXIgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09IFwiaWNlXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgeyByb29tTmFtZSwgaWNlIH0gPSBkYXRhO1xyXG4gICAgICAgICAgICBpZiAod3NzLmNsaWVudHMuaGFzKHJvb21OYW1lKSkge1xyXG4gICAgICAgICAgICAgIGZvciAoY29uc3QgY2xpZW50IG9mIHdzcy5jbGllbnRzLmdldChyb29tTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xyXG4gICAgICAgICAgICAgICAgICBjbGllbnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwiaWNlXCIsIGljZSB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICBjbGllbnQgIT09IHdzICYmXHJcbiAgICAgICAgICAgIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmXHJcbiAgICAgICAgICAgIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb24gJiZcclxuICAgICAgICAgICAgZGF0YS50eXBlID09PSBcImNoYXRcIlxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZSwgY2hhdCB9ID0gZGF0YTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXNzYWdlLnRvU3RyaW5nKClcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIC8vIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJjaGF0XCIsIG1lc3NhZ2UgfSkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB3cy5vbihcIm1lc3NhZ2VcIiwgKG1lc3NhZ2UpID0+IHtcclxuICAgIC8vICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XHJcbiAgICAvLyAgIGNvbnNvbGUubG9nKFwiZGF0YVwiKTtcclxuICAgIC8vICAgY29uc29sZS5sb2coZGF0YSk7XHJcblxyXG4gICAgLy8gICAvL+yeheyepe2WiOydhCDrloQg67OA7Zi47IKsIOydtOumhCDssYTtjIXsnLzroZwg7Lac66ClICsg7J2Y66Kw7J24IOydtOumhCDtmZTrqbTsl5Ag7Lac66ClXHJcbiAgICAvLyAgIHdzcy5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xyXG4gICAgLy8gICAgIGlmIChjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb24gJiYgZGF0YS50eXBlID09PSBcImVudGVyXCIpIHtcclxuICAgIC8vICAgICAgIGNvbnN0IHsgd2VsY29tZSwgZW50ZXIgfSA9IGRhdGE7XHJcbiAgICAvLyAgICAgICBjbGllbnQuc2VuZCh7dHlwZTogXCJlbnRlclwiLCBkYXRhIDogd2VsY29tZX0pO1xyXG4gICAgLy8gICAgICAgLy8gY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6IFwid2VsY29tZVwifSkpO1xyXG4gICAgLy8gICAgIH0gZWxzZSBpZihjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSB3cy5PUEVOICYmIGNsaWVudC5sb2NhdGlvbiA9PT0gd3MubG9jYXRpb24gJiYgZGF0YS50eXBlID09PSBcIm5hbWVcIil7XHJcbiAgICAvLyAgICAgICBjb25zdCB7IGNsaWVudE5hbWUsIG5hbWUgfSA9IGRhdGE7XHJcbiAgICAvLyAgICAgICBjbGllbnQuc2VuZCh7dHlwZTogXCJuYW1lXCIsIGRhdGEgOiBjbGllbnROYW1lfSk7XHJcbiAgICAvLyAgICAgICBjbGllbnQuc2VuZChjbGllbnROYW1lLnRvU3RyaW5nKCkpO1xyXG4gICAgLy8gICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSBcIm9mZmVyXCIpIHtcclxuICAgIC8vICAgICAgIGNvbnN0IHsgcm9vbU5hbWUsIG9mZmVyIH0gPSBkYXRhO1xyXG4gICAgLy8gICAgICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgIC8vICAgICAgICAgZm9yIChjb25zdCBjbGllbnQgb2Ygd3NzLmNsaWVudHMuZ2V0KHJvb21OYW1lKSkge1xyXG4gICAgLy8gICAgICAgICAgIGlmIChjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xyXG4gICAgLy8gICAgICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcIm9mZmVyXCIsIG9mZmVyIH0pKTtcclxuICAgIC8vICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgIH1cclxuICAgIC8vICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gXCJhbnN3ZXJcIikge1xyXG4gICAgLy8gICAgICAgY29uc3QgeyByb29tTmFtZSwgYW5zd2VyIH0gPSBkYXRhO1xyXG4gICAgLy8gICAgICAgaWYgKHdzcy5jbGllbnRzLmhhcyhyb29tTmFtZSkpIHtcclxuICAgIC8vICAgICAgICAgZm9yIChjb25zdCBjbGllbnQgb2Ygd3NzLmNsaWVudHMuZ2V0KHJvb21OYW1lKSkge1xyXG4gICAgLy8gICAgICAgICAgIGlmIChjbGllbnQgIT09IHdzICYmIGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xyXG4gICAgLy8gICAgICAgICAgICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcImFuc3dlclwiLCBhbnN3ZXIgfSkpO1xyXG4gICAgLy8gICAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgfVxyXG4gICAgLy8gICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSBcImljZVwiKSB7XHJcbiAgICAvLyAgICAgICBjb25zdCB7IHJvb21OYW1lLCBpY2UgfSA9IGRhdGE7XHJcbiAgICAvLyAgICAgICBpZiAod3NzLmNsaWVudHMuaGFzKHJvb21OYW1lKSkge1xyXG4gICAgLy8gICAgICAgICBmb3IgKGNvbnN0IGNsaWVudCBvZiB3c3MuY2xpZW50cy5nZXQocm9vbU5hbWUpKSB7XHJcbiAgICAvLyAgICAgICAgICAgaWYgKGNsaWVudCAhPT0gd3MgJiYgY2xpZW50LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBjbGllbnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwiaWNlXCIsIGljZSB9KSk7XHJcbiAgICAvLyAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICB9XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICB9KTtcclxuICAgIC8vIH0pO1xyXG5cclxuICAgIHdzLm9uKFwiZXJyb3JcIiwgKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICBhcHAubG9jYWxzLm1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xyXG4gICAgICBhcHAubG9jYWxzLmVycm9yID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwiIHByb2R1Y3Rpb25cIiA/IGVycm9yIDoge307XHJcbiAgICAgIGFwcC5yZW5kZXIoXCJlcnJvclwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHdzLm9uKFwiY2xvc2VcIiwgKCkgPT4gY29uc29sZS5sb2coYCR7cmVxLnVybH0gY29ubmVjdGlvbiBjbG9zZWApKTtcclxuICB9KTtcclxufTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQU1BLEVBQUUsR0FB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","map":{"version":3,"names":["ws","require","module","exports","server","app","wss","Server","set","on","req","console","log","url","location","send","JSON","stringify","get","rooms","startsWith","split","message","data","parse","clients","forEach","client","readyState","OPEN","toString","type","welcome","enter","clientName","name","roomName","offer","has","_iterator","_createForOfIteratorHelper","_step","s","n","done","value","WebSocket","err","e","f","answer","_iterator2","_step2","ice","_iterator3","_step3","chat","error","locals","process","env","NODE_ENV","render","concat"],"sourceRoot":"D:\\Final_Project\\src\\video\\","sources":["socket.js"],"sourcesContent":["const ws = require(\"ws\");\r\n\r\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\r\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\r\nmodule.exports = (server, app) => {\r\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\r\n  const wss = new ws.Server({ server });\r\n  // for sending a rooms data when a new room is created\r\n  // used at app.post('newroom') on app.js\r\n  app.set(\"wss\", wss);\r\n\r\n  // Backend에서 socket을 사용할 준비 완료\r\n  wss.on(\"connection\", (ws, req) => {\r\n    console.log(\"WebSocket connected to: \" + req.url);\r\n    if (req.url === \"/videoIndex\") {\r\n      ws.location = \"videoIndex\";\r\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\r\n    } else if (req.url.startsWith(\"/video/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      console.log(\"socket >>> ws.location : \" + ws.location);\r\n      ws.on(\"message\", (message) => {\r\n        const data = JSON.parse(message);\r\n        console.log(\"data\");\r\n        console.log(data);\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        // wss.clients.forEach((client) => {\r\n        //   if (\r\n        //     client !== ws &&\r\n        //     client.readyState === ws.OPEN &&\r\n        //     client.location === ws.location\r\n        //   ) {\r\n        //     client.send(message.toString());\r\n        //   }\r\n        // });\r\n        wss.clients.forEach((client) => {\r\n          if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location\r\n          ) {\r\n            client.send(message.toString());\r\n          } else if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location &&\r\n            data.type === \"enter\"\r\n          ) {\r\n            const { welcome, enter } = data;\r\n            console.log(\"welcome\");\r\n            console.log(welcome);\r\n            client.send({ type: \"enter\", data: welcome });\r\n            // client.send(JSON.stringify({type: \"welcome\"}));\r\n          } else if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location &&\r\n            data.type === \"name\"\r\n          ) {\r\n            const { clientName, name } = data;\r\n            console.log(\"clientName\");\r\n            console.log(clientName);\r\n            client.send({ type: \"name\", data: clientName });\r\n            // client.send(clientName.toString());\r\n          } else if (data.type === \"offer\") {\r\n            const { roomName, offer } = data;\r\n            if (wss.clients.has(roomName)) {\r\n              for (const client of wss.clients.get(roomName)) {\r\n                if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n                  client.send(JSON.stringify({ type: \"offer\", offer }));\r\n                }\r\n              }\r\n            }\r\n          } else if (data.type === \"answer\") {\r\n            const { roomName, answer } = data;\r\n            if (wss.clients.has(roomName)) {\r\n              for (const client of wss.clients.get(roomName)) {\r\n                if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n                  client.send(JSON.stringify({ type: \"answer\", answer }));\r\n                }\r\n              }\r\n            }\r\n          } else if (data.type === \"ice\") {\r\n            const { roomName, ice } = data;\r\n            if (wss.clients.has(roomName)) {\r\n              for (const client of wss.clients.get(roomName)) {\r\n                if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n                  client.send(JSON.stringify({ type: \"ice\", ice }));\r\n                }\r\n              }\r\n            }\r\n          } else if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location &&\r\n            data.type === \"chat\"\r\n          ) {\r\n            const { message, chat } = data;\r\n            console.log(\"message.toString()\");\r\n            console.log(message.toString());\r\n            // client.send(message.toString());\r\n            client.send(JSON.stringify({ type: \"chat\", message }));\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    // ws.on(\"message\", (message) => {\r\n    //   const data = JSON.parse(message);\r\n    //   console.log(\"data\");\r\n    //   console.log(data);\r\n\r\n    //   //입장했을 떄 변호사 이름 채팅으로 출력 + 의뢰인 이름 화면에 출력\r\n    //   wss.clients.forEach((client) => {\r\n    //     if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"enter\") {\r\n    //       const { welcome, enter } = data;\r\n    //       client.send({type: \"enter\", data : welcome});\r\n    //       // client.send(JSON.stringify({type: \"welcome\"}));\r\n    //     } else if(client !== ws && client.readyState === ws.OPEN && client.location === ws.location && data.type === \"name\"){\r\n    //       const { clientName, name } = data;\r\n    //       client.send({type: \"name\", data : clientName});\r\n    //       client.send(clientName.toString());\r\n    //     } else if (data.type === \"offer\") {\r\n    //       const { roomName, offer } = data;\r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"offer\", offer }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     } else if (data.type === \"answer\") {\r\n    //       const { roomName, answer } = data;\r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"answer\", answer }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     } else if (data.type === \"ice\") {\r\n    //       const { roomName, ice } = data;\r\n    //       if (wss.clients.has(roomName)) {\r\n    //         for (const client of wss.clients.get(roomName)) {\r\n    //           if (client !== ws && client.readyState === WebSocket.OPEN) {\r\n    //             client.send(JSON.stringify({ type: \"ice\", ice }));\r\n    //           }\r\n    //         }\r\n    //       }\r\n    //     }\r\n    //   });\r\n    // });\r\n\r\n    ws.on(\"error\", (error) => {\r\n      console.error(error);\r\n      app.locals.message = error.message;\r\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\r\n      app.render(\"error\");\r\n    });\r\n\r\n    ws.on(\"close\", () => console.log(`${req.url} connection close`));\r\n  });\r\n};\r\n"],"mappings":"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"}},"mtime":1706259313435},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nvar express = require(\"express\");\nvar session = require(\"express-session\");\nvar mysql = require(\"mysql\");\nvar cors = require(\"cors\");\nvar conn = mysql.createConnection({\n  host: \"175.198.206.137\",\n  port: 3306,\n  user: \"q\",\n  password: \"q\",\n  database: \"follaw\"\n});\nconn.connect(function (err) {\n  if (err) {\n    console.error(\"MySQL 연결 오류\");\n    return;\n  }\n  console.log(\"MySQL에 성공적으로 연결되었습니다.\");\n});\nvar app = express();\napp.set(\"port\", process.env.PORT || 3000);\napp.set(\"views\", __dirname + \"/views\");\napp.set(\"view engine\", \"pug\");\napp.use(\"/public\", express[\"static\"](__dirname + \"/public\"));\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: false\n}));\nvar corsOptions = {\n  origin: \"http://your-client-domain:your-client-port\",\n  methods: \"GET,HEAD,PUT,PATCH,POST,DELETE\",\n  credentials: true\n};\napp.use(cors(corsOptions));\napp.use(session({\n  resave: false,\n  saveUninitialized: false,\n  //COOKIE_SECRET 환경 변수가 설정되어 있다면 그 값을 사용하고,\n  //설정되어 있지 않다면 \"secret\"이라는 기본값을 사용하여 세션 데이터를 암호화\n  secret: process.env.COOKIE_SECRET || \"secret\",\n  cookie: {\n    //httpOnly: true는 클라이언트에서 세션 쿠키에 접근할 때 JavaScript를 통한 접근을 막는 옵션\n    httpOnly: true,\n    //secure: false는 세션 쿠키를 안전한 연결(HTTPS)을 통해서만 전송해야 하는지 여부를 설정하는 옵션\n    secure: false\n  }\n}));\napp.use(function (req, res, next) {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  next();\n});\n\n//************** 채팅 시작 **************/\napp.set(\"dummyDb\", {\n  rooms: new Array()\n});\napp.get(\"/\", function (req, res) {\n  // TODO: add user\n  return res.render(\"index\");\n});\napp.post(\"/\", function (req, res) {\n  // TODO: add user\n  return res.render(\"index\");\n});\napp.post(\"/newRoom\", function (req, res) {\n  var _req$body = req.body,\n    title = _req$body.title,\n    auth = _req$body.auth,\n    user = _req$body.user;\n  var roomId = req.sessionID + Date.now();\n  var totalCount = 0;\n  var _app$get = app.get(\"dummyDb\"),\n    rooms = _app$get.rooms;\n  if (auth == 0) {\n    totalCount += 1;\n  }\n  console.log(\"app.js / user :\" + user);\n  rooms.push({\n    title: title,\n    roomId: roomId,\n    totalCount: totalCount\n  });\n  console.log(\"app.js / newRoom >>> title : \" + title);\n  var sql = \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(0, ?, ?, now())\";\n  var value = [title, user];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n\n  // 채팅방 새로 생성시 홈에 있는 사람들에게 새로은 방 목록 전송\n  // Q?: 본인은 왜 제외될까?\n  // A!: 나는 현재 연결된 소켓이 없는상태임 home에서 newroom 으로 갈때 connection이 끊어지고\n  //     redirect로 /chat/:roomId로 보내져야 chat.js에서 connection을 연결함\n  app.get(\"wss\").clients.forEach(function (client) {\n    if (client.location === \"index\" && client.readyState === client.OPEN) client.send(JSON.stringify(rooms));\n  });\n  return res.redirect(\"/chat/\".concat(roomId));\n});\napp.get(\"/chat/:roomId\", function (req, res) {\n  var user = req.query.user;\n  console.log(\"/chat/:roomId >>> user : \" + user);\n  var _app$get$rooms$find = app.get(\"dummyDb\").rooms.find(function (room) {\n      return room.roomId === req.params.roomId;\n    }),\n    title = _app$get$rooms$find.title;\n\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\n  console.log(\"app.js/title :\" + title);\n  res.locals.title = title;\n  var targetRoom = app.get(\"dummyDb\").rooms.find(function (room) {\n    return room.roomId === req.params.roomId;\n  });\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\n  targetRoom.totalCount += 1;\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\n  var sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\n  var value = [user, title];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\n  res.render(\"chat\");\n});\n\n// let totalCount = 0;\n\napp.post(\"/leave-room\", function (req, res) {\n  var _req$body2 = req.body,\n    title = _req$body2.title,\n    auth = _req$body2.auth;\n  console.log(\"app.js/title :\" + title);\n  console.log(\"app.js/auth :\" + auth);\n  var _app$get2 = app.get(\"dummyDb\"),\n    rooms = _app$get2.rooms;\n  console.log(rooms);\n  console.log(\"--------------------\");\n\n  // rooms.totalCount += count;\n  // console.log(\"totalCount : \" + totalCount);\n\n  var foundRoom = rooms.find(function (room) {\n    return room.title === title;\n  });\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\n  if (foundRoom) {\n    if (auth == 1) {\n      foundRoom.totalCount -= 1;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    } else if (auth == 0) {\n      foundRoom.totalCount = 0;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    }\n    if (foundRoom.totalCount == 0) {\n      var index = rooms.indexOf(foundRoom);\n      console.log(\"app.js/index : \" + index);\n      if (index !== -1) {\n        rooms.splice(index, 1);\n        var sql = \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\n        var value = [title];\n        conn.query(sql, value, function (err, result, fields) {\n          if (err) throw err;\n          console.log(result);\n        });\n      }\n    }\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\n    console.log(rooms);\n  }\n  return res.render(\"index\", {\n    rooms: rooms\n  });\n});\n\n//************** 채팅 끝 **************/\n\n//************** 화상 시작 **************/\napp.set(\"dummyDb2\", {\n  rooms: new Array()\n});\napp.get(\"/videoIndex\", function (req, res) {\n  // TODO: add user\n  return res.render(\"videoIndex\");\n});\napp.post(\"/videoIndex\", function (req, res) {\n  // TODO: add user\n  return res.render(\"videoIndex\");\n});\napp.post(\"/videoIndex/newRoom\", function (req, res) {\n  var _req$body3 = req.body,\n    title = _req$body3.title,\n    auth = _req$body3.auth,\n    user = _req$body3.user;\n  var roomId = req.sessionID + Date.now();\n  var totalCount = 0;\n  var _app$get3 = app.get(\"dummyDb2\"),\n    rooms = _app$get3.rooms;\n  if (auth == 0) {\n    totalCount += 1;\n  }\n  console.log(\"app.js / user :\" + user);\n  rooms.push({\n    title: title,\n    roomId: roomId,\n    totalCount: totalCount\n  });\n  console.log(\"app.js / newRoom : \" + rooms);\n  var sql = \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(1, ?, ?, now())\";\n  var value = [title, user];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n\n  // 채팅방 새로 생성시 홈에 있는 사람들에게 새로은 방 목록 전송\n  // Q?: 본인은 왜 제외될까?\n  // A!: 나는 현재 연결된 소켓이 없는상태임 home에서 newroom 으로 갈때 connection이 끊어지고\n  //     redirect로 /chat/:roomId로 보내져야 chat.js에서 connection을 연결함\n  app.get(\"wss\").clients.forEach(function (client) {\n    if (client.location === \"videoIndex\" && client.readyState === client.OPEN) client.send(JSON.stringify(rooms));\n  });\n  return res.redirect(\"/video/\".concat(roomId));\n});\napp.get(\"/video/:roomId\", function (req, res) {\n  var user = req.query.user;\n  console.log(\"/video/:roomId  >>> user : \" + user);\n  var _app$get$rooms$find2 = app.get(\"dummyDb2\").rooms.find(function (room) {\n      return room.roomId === req.params.roomId;\n    }),\n    title = _app$get$rooms$find2.title;\n\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\n  console.log(\"app.js/title :\" + title);\n  res.locals.title = title;\n  var targetRoom = app.get(\"dummyDb2\").rooms.find(function (room) {\n    return room.roomId === req.params.roomId;\n  });\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\n  targetRoom.totalCount += 1;\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\n  var sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\n  var value = [user, title];\n  conn.query(sql, value, function (err, result, fields) {\n    if (err) throw err;\n    console.log(result);\n  });\n\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\n  res.render(\"video\");\n});\napp.post(\"/videoIndex/leave-room\", function (req, res) {\n  var _req$body4 = req.body,\n    title = _req$body4.title,\n    auth = _req$body4.auth;\n  console.log(\"app.js/title :\" + title);\n  console.log(\"app.js/auth :\" + auth);\n  var _app$get4 = app.get(\"dummyDb2\"),\n    rooms = _app$get4.rooms;\n  console.log(rooms);\n  console.log(\"--------------------\");\n\n  // rooms.totalCount += count;\n  // console.log(\"totalCount : \" + totalCount);\n\n  var foundRoom = rooms.find(function (room) {\n    return room.title === title;\n  });\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\n  if (foundRoom) {\n    if (auth == 1) {\n      foundRoom.totalCount -= 1;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    } else if (auth == 0) {\n      foundRoom.totalCount = 0;\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\n    }\n    if (foundRoom.totalCount == 0) {\n      var index = rooms.indexOf(foundRoom);\n      console.log(\"app.js/index : \" + index);\n      if (index !== -1) {\n        rooms.splice(index, 1);\n        var sql = \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\n        var value = [title];\n        conn.query(sql, value, function (err, result, fields) {\n          if (err) throw err;\n          console.log(result);\n        });\n      }\n    }\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\n    console.log(rooms);\n  }\n  return res.render(\"videoIndex\", {\n    rooms: rooms\n  });\n});\n\n//************** 화상 끝 **************/\n\napp.use(function (err, req, res, next) {\n  res.locals.message = err.message;\n  res.locals.error = process.env.NODE_ENV !== \" production\" ? err : {};\n  res.status(err.status || 500).render(\"error\");\n});\nvar expressServer = app.listen(app.get(\"port\"), function () {\n  return console.log(\"Listening on http://localhost:3000\");\n});\n\n// socket\nrequire(\"./socket\")(expressServer, app);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInNlc3Npb24iLCJteXNxbCIsImNvcnMiLCJjb25uIiwiY3JlYXRlQ29ubmVjdGlvbiIsImhvc3QiLCJwb3J0IiwidXNlciIsInBhc3N3b3JkIiwiZGF0YWJhc2UiLCJjb25uZWN0IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibG9nIiwiYXBwIiwic2V0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJfX2Rpcm5hbWUiLCJ1c2UiLCJqc29uIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwiY29yc09wdGlvbnMiLCJvcmlnaW4iLCJtZXRob2RzIiwiY3JlZGVudGlhbHMiLCJyZXNhdmUiLCJzYXZlVW5pbml0aWFsaXplZCIsInNlY3JldCIsIkNPT0tJRV9TRUNSRVQiLCJjb29raWUiLCJodHRwT25seSIsInNlY3VyZSIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFkZXIiLCJyb29tcyIsIkFycmF5IiwiZ2V0IiwicmVuZGVyIiwicG9zdCIsIl9yZXEkYm9keSIsImJvZHkiLCJ0aXRsZSIsImF1dGgiLCJyb29tSWQiLCJzZXNzaW9uSUQiLCJEYXRlIiwibm93IiwidG90YWxDb3VudCIsIl9hcHAkZ2V0IiwicHVzaCIsInNxbCIsInZhbHVlIiwicXVlcnkiLCJyZXN1bHQiLCJmaWVsZHMiLCJjbGllbnRzIiwiZm9yRWFjaCIsImNsaWVudCIsImxvY2F0aW9uIiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsInJlZGlyZWN0IiwiY29uY2F0IiwiX2FwcCRnZXQkcm9vbXMkZmluZCIsImZpbmQiLCJyb29tIiwicGFyYW1zIiwibG9jYWxzIiwidGFyZ2V0Um9vbSIsIl9yZXEkYm9keTIiLCJfYXBwJGdldDIiLCJmb3VuZFJvb20iLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJfcmVxJGJvZHkzIiwiX2FwcCRnZXQzIiwiX2FwcCRnZXQkcm9vbXMkZmluZDIiLCJfcmVxJGJvZHk0IiwiX2FwcCRnZXQ0IiwibWVzc2FnZSIsIk5PREVfRU5WIiwic3RhdHVzIiwiZXhwcmVzc1NlcnZlciIsImxpc3RlbiJdLCJzb3VyY2VSb290IjoiRDpcXEZpbmFsX1Byb2plY3RcXHNyY1xcb3Blbi1jaGF0c1xcIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG5jb25zdCBzZXNzaW9uID0gcmVxdWlyZShcImV4cHJlc3Mtc2Vzc2lvblwiKTtcclxuY29uc3QgbXlzcWwgPSByZXF1aXJlKFwibXlzcWxcIik7XHJcbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKTtcclxuXHJcbmNvbnN0IGNvbm4gPSBteXNxbC5jcmVhdGVDb25uZWN0aW9uKHtcclxuICBob3N0OiBcIjE3NS4xOTguMjA2LjEzN1wiLFxyXG4gIHBvcnQ6IDMzMDYsXHJcbiAgdXNlcjogXCJxXCIsXHJcbiAgcGFzc3dvcmQ6IFwicVwiLFxyXG4gIGRhdGFiYXNlOiBcImZvbGxhd1wiLFxyXG59KTtcclxuXHJcbmNvbm4uY29ubmVjdCgoZXJyKSA9PiB7XHJcbiAgaWYgKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIk15U1FMIOyXsOqysCDsmKTrpZhcIik7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKFwiTXlTUUzsl5Ag7ISx6rO17KCB7Jy866GcIOyXsOqysOuQmOyXiOyKteuLiOuLpC5cIik7XHJcbn0pO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5hcHAuc2V0KFwicG9ydFwiLCBwcm9jZXNzLmVudi5QT1JUIHx8IDMwMDApO1xyXG5hcHAuc2V0KFwidmlld3NcIiwgX19kaXJuYW1lICsgXCIvdmlld3NcIik7XHJcbmFwcC5zZXQoXCJ2aWV3IGVuZ2luZVwiLCBcInB1Z1wiKTtcclxuYXBwLnVzZShcIi9wdWJsaWNcIiwgZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lICsgXCIvcHVibGljXCIpKTtcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IGZhbHNlIH0pKTtcclxuXHJcbmNvbnN0IGNvcnNPcHRpb25zID0ge1xyXG4gIG9yaWdpbjogXCJodHRwOi8veW91ci1jbGllbnQtZG9tYWluOnlvdXItY2xpZW50LXBvcnRcIixcclxuICBtZXRob2RzOiBcIkdFVCxIRUFELFBVVCxQQVRDSCxQT1NULERFTEVURVwiLFxyXG4gIGNyZWRlbnRpYWxzOiB0cnVlLFxyXG59O1xyXG5cclxuYXBwLnVzZShjb3JzKGNvcnNPcHRpb25zKSk7XHJcblxyXG5hcHAudXNlKFxyXG4gIHNlc3Npb24oe1xyXG4gICAgcmVzYXZlOiBmYWxzZSxcclxuICAgIHNhdmVVbmluaXRpYWxpemVkOiBmYWxzZSxcclxuICAgIC8vQ09PS0lFX1NFQ1JFVCDtmZjqsr0g67OA7IiY6rCAIOyEpOygleuQmOyWtCDsnojri6TrqbQg6re4IOqwkuydhCDsgqzsmqntlZjqs6AsXHJcbiAgICAvL+yEpOygleuQmOyWtCDsnojsp4Ag7JWK64uk66m0IFwic2VjcmV0XCLsnbTrnbzripQg6riw67O46rCS7J2EIOyCrOyaqe2VmOyXrCDshLjshZgg642w7J207YSw66W8IOyVlO2YuO2ZlFxyXG4gICAgc2VjcmV0OiBwcm9jZXNzLmVudi5DT09LSUVfU0VDUkVUIHx8IFwic2VjcmV0XCIsXHJcbiAgICBjb29raWU6IHtcclxuICAgICAgLy9odHRwT25seTogdHJ1ZeuKlCDtgbTrnbzsnbTslrjtirjsl5DshJwg7IS47IWYIOy/oO2CpOyXkCDsoJHqt7ztlaAg65WMIEphdmFTY3JpcHTrpbwg7Ya17ZWcIOygkeq3vOydhCDrp4nripQg7Ji17IWYXHJcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICAvL3NlY3VyZTogZmFsc2XripQg7IS47IWYIOy/oO2CpOulvCDslYjsoITtlZwg7Jew6rKwKEhUVFBTKeydhCDthrXtlbTshJzrp4wg7KCE7Iah7ZW07JW8IO2VmOuKlOyngCDsl6zrtoDrpbwg7ISk7KCV7ZWY64qUIOyYteyFmFxyXG4gICAgICBzZWN1cmU6IGZhbHNlLFxyXG4gICAgfSxcclxuICB9KVxyXG4pO1xyXG5hcHAudXNlKChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIHJlcy5oZWFkZXIoXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cIiwgXCIqXCIpO1xyXG4gIHJlcy5oZWFkZXIoXHJcbiAgICBcIkFjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnNcIixcclxuICAgIFwiT3JpZ2luLCBYLVJlcXVlc3RlZC1XaXRoLCBDb250ZW50LVR5cGUsIEFjY2VwdFwiXHJcbiAgKTtcclxuICBuZXh0KCk7XHJcbn0pO1xyXG5cclxuLy8qKioqKioqKioqKioqKiDssYTtjIUg7Iuc7J6RICoqKioqKioqKioqKioqL1xyXG5hcHAuc2V0KFwiZHVtbXlEYlwiLCB7IHJvb21zOiBuZXcgQXJyYXkoKSB9KTtcclxuXHJcbmFwcC5nZXQoXCIvXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gIC8vIFRPRE86IGFkZCB1c2VyXHJcbiAgcmV0dXJuIHJlcy5yZW5kZXIoXCJpbmRleFwiKTtcclxufSk7XHJcblxyXG5hcHAucG9zdChcIi9cIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgLy8gVE9ETzogYWRkIHVzZXJcclxuICByZXR1cm4gcmVzLnJlbmRlcihcImluZGV4XCIpO1xyXG59KTtcclxuXHJcbmFwcC5wb3N0KFwiL25ld1Jvb21cIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgY29uc3QgeyB0aXRsZSwgYXV0aCwgdXNlciB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgcm9vbUlkID0gcmVxLnNlc3Npb25JRCArIERhdGUubm93KCk7XHJcbiAgbGV0IHRvdGFsQ291bnQgPSAwO1xyXG4gIGNvbnN0IHsgcm9vbXMgfSA9IGFwcC5nZXQoXCJkdW1teURiXCIpO1xyXG5cclxuICBpZiAoYXV0aCA9PSAwKSB7XHJcbiAgICB0b3RhbENvdW50ICs9IDE7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZyhcImFwcC5qcyAvIHVzZXIgOlwiICsgdXNlcik7XHJcblxyXG4gIHJvb21zLnB1c2goeyB0aXRsZSwgcm9vbUlkLCB0b3RhbENvdW50IH0pO1xyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzIC8gbmV3Um9vbSA+Pj4gdGl0bGUgOiBcIiArIHRpdGxlKTtcclxuXHJcbiAgY29uc3Qgc3FsID1cclxuICAgIFwiSU5TRVJUIElOVE8gY2hhdChjaGF0X3R5cGUsIGNoYXRfdGl0bGUsIHVzZXJfaWQsIGNoYXRfY3JlYXRlZCkgVkFMVUVTKDAsID8sID8sIG5vdygpKVwiO1xyXG4gIGNvbnN0IHZhbHVlID0gW3RpdGxlLCB1c2VyXTtcclxuXHJcbiAgY29ubi5xdWVyeShzcWwsIHZhbHVlLCAoZXJyLCByZXN1bHQsIGZpZWxkcykgPT4ge1xyXG4gICAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTtcclxuXHJcbiAgLy8g7LGE7YyF67CpIOyDiOuhnCDsg53shLHsi5wg7ZmI7JeQIOyeiOuKlCDsgqzrnozrk6Tsl5Dqsowg7IOI66Gc7J2AIOuwqSDrqqnroZ0g7KCE7IahXHJcbiAgLy8gUT86IOuzuOyduOydgCDsmZwg7KCc7Jm465Cg6rmMP1xyXG4gIC8vIEEhOiDrgpjripQg7ZiE7J6sIOyXsOqysOuQnCDshozsvJPsnbQg7JeG64qU7IOB7YOc7J6EIGhvbWXsl5DshJwgbmV3cm9vbSDsnLzroZwg6rCI65WMIGNvbm5lY3Rpb27snbQg64GK7Ja07KeA6rOgXHJcbiAgLy8gICAgIHJlZGlyZWN066GcIC9jaGF0Lzpyb29tSWTroZwg67O064K07KC47JW8IGNoYXQuanPsl5DshJwgY29ubmVjdGlvbuydhCDsl7DqsrDtlahcclxuICBhcHAuZ2V0KFwid3NzXCIpLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XHJcbiAgICBpZiAoY2xpZW50LmxvY2F0aW9uID09PSBcImluZGV4XCIgJiYgY2xpZW50LnJlYWR5U3RhdGUgPT09IGNsaWVudC5PUEVOKVxyXG4gICAgICBjbGllbnQuc2VuZChKU09OLnN0cmluZ2lmeShyb29tcykpO1xyXG4gIH0pO1xyXG4gIHJldHVybiByZXMucmVkaXJlY3QoYC9jaGF0LyR7cm9vbUlkfWApO1xyXG59KTtcclxuXHJcbmFwcC5nZXQoXCIvY2hhdC86cm9vbUlkXCIsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgdXNlciB9ID0gcmVxLnF1ZXJ5O1xyXG4gIGNvbnNvbGUubG9nKFwiL2NoYXQvOnJvb21JZCA+Pj4gdXNlciA6IFwiICsgdXNlcik7XHJcbiAgY29uc3QgeyB0aXRsZSB9ID0gYXBwXHJcbiAgICAuZ2V0KFwiZHVtbXlEYlwiKVxyXG4gICAgLnJvb21zLmZpbmQoKHJvb20pID0+IHJvb20ucm9vbUlkID09PSByZXEucGFyYW1zLnJvb21JZCk7XHJcblxyXG4gIC8vcmVzLmxvY2Fsc+uKlCDsnZHri7Ug6rCd7LK0KHJlcynsnZgg7IaN7ISx7Jy866GcLCDtlbTri7kg7J2R64u17JeQIOuMgO2VnCDroZzsu6wg67OA7IiY66W8IOyEpOygle2VmOqzoCDsgqzsmqntlaAg7IiYIOyeiOqyjCDtlbTspIxcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy90aXRsZSA6XCIgKyB0aXRsZSk7XHJcbiAgcmVzLmxvY2Fscy50aXRsZSA9IHRpdGxlO1xyXG5cclxuICBjb25zdCB0YXJnZXRSb29tID0gYXBwXHJcbiAgICAuZ2V0KFwiZHVtbXlEYlwiKVxyXG4gICAgLnJvb21zLmZpbmQoKHJvb20pID0+IHJvb20ucm9vbUlkID09PSByZXEucGFyYW1zLnJvb21JZCk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzL3RhcmdldFJvb20xIDpcIiArIHRhcmdldFJvb20udG90YWxDb3VudCk7XHJcbiAgdGFyZ2V0Um9vbS50b3RhbENvdW50ICs9IDE7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzL3RhcmdldFJvb20yIDpcIiArIHRhcmdldFJvb20udG90YWxDb3VudCk7XHJcblxyXG4gIGNvbnN0IHNxbCA9IFwiVVBEQVRFIGNoYXQgU0VUIGxhd3llcl9pZD0/IFdIRVJFIGNoYXRfdGl0bGUgPSA/XCI7XHJcbiAgY29uc3QgdmFsdWUgPSBbdXNlciwgdGl0bGVdO1xyXG5cclxuICBjb25uLnF1ZXJ5KHNxbCwgdmFsdWUsIChlcnIsIHJlc3VsdCwgZmllbGRzKSA9PiB7XHJcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnI7XHJcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gIH0pO1xyXG5cclxuICAvL2NoYXQg7YyM7J287J2EIOugjOuNlOunge2VmOyXrCDtlbTri7kg7YyM7J287JeQ7IScIHRpdGxlIOuzgOyImOulvCDsgqzsmqntlaAg7IiYIOyeiOydjFxyXG4gIHJlcy5yZW5kZXIoXCJjaGF0XCIpO1xyXG59KTtcclxuXHJcbi8vIGxldCB0b3RhbENvdW50ID0gMDtcclxuXHJcbmFwcC5wb3N0KFwiL2xlYXZlLXJvb21cIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgY29uc3QgeyB0aXRsZSwgYXV0aCB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMvdGl0bGUgOlwiICsgdGl0bGUpO1xyXG4gIGNvbnNvbGUubG9nKFwiYXBwLmpzL2F1dGggOlwiICsgYXV0aCk7XHJcbiAgbGV0IHsgcm9vbXMgfSA9IGFwcC5nZXQoXCJkdW1teURiXCIpO1xyXG4gIGNvbnNvbGUubG9nKHJvb21zKTtcclxuICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG5cclxuICAvLyByb29tcy50b3RhbENvdW50ICs9IGNvdW50O1xyXG4gIC8vIGNvbnNvbGUubG9nKFwidG90YWxDb3VudCA6IFwiICsgdG90YWxDb3VudCk7XHJcblxyXG4gIGNvbnN0IGZvdW5kUm9vbSA9IHJvb21zLmZpbmQoKHJvb20pID0+IHJvb20udGl0bGUgPT09IHRpdGxlKTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy9mb3VuZFJvb20udG90YWxDb3VudCA6XCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcblxyXG4gIGlmIChmb3VuZFJvb20pIHtcclxuICAgIGlmIChhdXRoID09IDEpIHtcclxuICAgICAgZm91bmRSb29tLnRvdGFsQ291bnQgLT0gMTtcclxuICAgICAgY29uc29sZS5sb2coXCJhcHAuanMvdG90YWxDb3VudDExMSA6IFwiICsgZm91bmRSb29tLnRvdGFsQ291bnQpO1xyXG4gICAgfSBlbHNlIGlmIChhdXRoID09IDApIHtcclxuICAgICAgZm91bmRSb29tLnRvdGFsQ291bnQgPSAwO1xyXG4gICAgICBjb25zb2xlLmxvZyhcImFwcC5qcy90b3RhbENvdW50MTExIDogXCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZvdW5kUm9vbS50b3RhbENvdW50ID09IDApIHtcclxuICAgICAgY29uc3QgaW5kZXggPSByb29tcy5pbmRleE9mKGZvdW5kUm9vbSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiYXBwLmpzL2luZGV4IDogXCIgKyBpbmRleCk7XHJcbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICByb29tcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBjb25zdCBzcWwgPVxyXG4gICAgICAgICAgXCJVUERBVEUgY2hhdCBTRVQgY2hhdHRpbmdfY2xvc2VkPW5vdygpIFdIRVJFIGNoYXRfdGl0bGUgPSA/XCI7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBbdGl0bGVdO1xyXG5cclxuICAgICAgICBjb25uLnF1ZXJ5KHNxbCwgdmFsdWUsIChlcnIsIHJlc3VsdCwgZmllbGRzKSA9PiB7XHJcbiAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnI7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcImFwcC5qcy90b3RhbENvdW50MjIyIDogXCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcbiAgICBjb25zb2xlLmxvZyhyb29tcyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzLnJlbmRlcihcImluZGV4XCIsIHsgcm9vbXMgfSk7XHJcbn0pO1xyXG5cclxuLy8qKioqKioqKioqKioqKiDssYTtjIUg64GdICoqKioqKioqKioqKioqL1xyXG5cclxuLy8qKioqKioqKioqKioqKiDtmZTsg4Eg7Iuc7J6RICoqKioqKioqKioqKioqL1xyXG5hcHAuc2V0KFwiZHVtbXlEYjJcIiwgeyByb29tczogbmV3IEFycmF5KCkgfSk7XHJcblxyXG5hcHAuZ2V0KFwiL3ZpZGVvSW5kZXhcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgLy8gVE9ETzogYWRkIHVzZXJcclxuICByZXR1cm4gcmVzLnJlbmRlcihcInZpZGVvSW5kZXhcIik7XHJcbn0pO1xyXG5cclxuYXBwLnBvc3QoXCIvdmlkZW9JbmRleFwiLCAocmVxLCByZXMpID0+IHtcclxuICAvLyBUT0RPOiBhZGQgdXNlclxyXG4gIHJldHVybiByZXMucmVuZGVyKFwidmlkZW9JbmRleFwiKTtcclxufSk7XHJcblxyXG5hcHAucG9zdChcIi92aWRlb0luZGV4L25ld1Jvb21cIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgY29uc3QgeyB0aXRsZSwgYXV0aCwgdXNlciB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgcm9vbUlkID0gcmVxLnNlc3Npb25JRCArIERhdGUubm93KCk7XHJcbiAgbGV0IHRvdGFsQ291bnQgPSAwO1xyXG4gIGNvbnN0IHsgcm9vbXMgfSA9IGFwcC5nZXQoXCJkdW1teURiMlwiKTtcclxuXHJcbiAgaWYgKGF1dGggPT0gMCkge1xyXG4gICAgdG90YWxDb3VudCArPSAxO1xyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMgLyB1c2VyIDpcIiArIHVzZXIpO1xyXG5cclxuICByb29tcy5wdXNoKHsgdGl0bGUsIHJvb21JZCwgdG90YWxDb3VudCB9KTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcyAvIG5ld1Jvb20gOiBcIiArIHJvb21zKTtcclxuXHJcbiAgY29uc3Qgc3FsID1cclxuICAgIFwiSU5TRVJUIElOVE8gY2hhdChjaGF0X3R5cGUsIGNoYXRfdGl0bGUsIHVzZXJfaWQsIGNoYXRfY3JlYXRlZCkgVkFMVUVTKDEsID8sID8sIG5vdygpKVwiO1xyXG4gIGNvbnN0IHZhbHVlID0gW3RpdGxlLCB1c2VyXTtcclxuXHJcbiAgY29ubi5xdWVyeShzcWwsIHZhbHVlLCAoZXJyLCByZXN1bHQsIGZpZWxkcykgPT4ge1xyXG4gICAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTtcclxuXHJcbiAgLy8g7LGE7YyF67CpIOyDiOuhnCDsg53shLHsi5wg7ZmI7JeQIOyeiOuKlCDsgqzrnozrk6Tsl5Dqsowg7IOI66Gc7J2AIOuwqSDrqqnroZ0g7KCE7IahXHJcbiAgLy8gUT86IOuzuOyduOydgCDsmZwg7KCc7Jm465Cg6rmMP1xyXG4gIC8vIEEhOiDrgpjripQg7ZiE7J6sIOyXsOqysOuQnCDshozsvJPsnbQg7JeG64qU7IOB7YOc7J6EIGhvbWXsl5DshJwgbmV3cm9vbSDsnLzroZwg6rCI65WMIGNvbm5lY3Rpb27snbQg64GK7Ja07KeA6rOgXHJcbiAgLy8gICAgIHJlZGlyZWN066GcIC9jaGF0Lzpyb29tSWTroZwg67O064K07KC47JW8IGNoYXQuanPsl5DshJwgY29ubmVjdGlvbuydhCDsl7DqsrDtlahcclxuICBhcHAuZ2V0KFwid3NzXCIpLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XHJcbiAgICBpZiAoY2xpZW50LmxvY2F0aW9uID09PSBcInZpZGVvSW5kZXhcIiAmJiBjbGllbnQucmVhZHlTdGF0ZSA9PT0gY2xpZW50Lk9QRU4pXHJcbiAgICAgIGNsaWVudC5zZW5kKEpTT04uc3RyaW5naWZ5KHJvb21zKSk7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHJlcy5yZWRpcmVjdChgL3ZpZGVvLyR7cm9vbUlkfWApO1xyXG59KTtcclxuXHJcbmFwcC5nZXQoXCIvdmlkZW8vOnJvb21JZFwiLCAocmVxLCByZXMpID0+IHtcclxuICBjb25zdCB7IHVzZXIgfSA9IHJlcS5xdWVyeTtcclxuICBjb25zb2xlLmxvZyhcIi92aWRlby86cm9vbUlkICA+Pj4gdXNlciA6IFwiICsgdXNlcik7XHJcbiAgY29uc3QgeyB0aXRsZSB9ID0gYXBwXHJcbiAgICAuZ2V0KFwiZHVtbXlEYjJcIilcclxuICAgIC5yb29tcy5maW5kKChyb29tKSA9PiByb29tLnJvb21JZCA9PT0gcmVxLnBhcmFtcy5yb29tSWQpO1xyXG5cclxuICAvL3Jlcy5sb2NhbHPripQg7J2R64u1IOqwneyytChyZXMp7J2YIOyGjeyEseycvOuhnCwg7ZW064u5IOydkeuLteyXkCDrjIDtlZwg66Gc7LusIOuzgOyImOulvCDshKTsoJXtlZjqs6Ag7IKs7Jqp7ZWgIOyImCDsnojqsowg7ZW07KSMXHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMvdGl0bGUgOlwiICsgdGl0bGUpO1xyXG4gIHJlcy5sb2NhbHMudGl0bGUgPSB0aXRsZTtcclxuXHJcbiAgY29uc3QgdGFyZ2V0Um9vbSA9IGFwcFxyXG4gICAgLmdldChcImR1bW15RGIyXCIpXHJcbiAgICAucm9vbXMuZmluZCgocm9vbSkgPT4gcm9vbS5yb29tSWQgPT09IHJlcS5wYXJhbXMucm9vbUlkKTtcclxuXHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMvdGFyZ2V0Um9vbTEgOlwiICsgdGFyZ2V0Um9vbS50b3RhbENvdW50KTtcclxuICB0YXJnZXRSb29tLnRvdGFsQ291bnQgKz0gMTtcclxuXHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMvdGFyZ2V0Um9vbTIgOlwiICsgdGFyZ2V0Um9vbS50b3RhbENvdW50KTtcclxuXHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgY2hhdCBTRVQgbGF3eWVyX2lkPT8gV0hFUkUgY2hhdF90aXRsZSA9ID9cIjtcclxuICBjb25zdCB2YWx1ZSA9IFt1c2VyLCB0aXRsZV07XHJcblxyXG4gIGNvbm4ucXVlcnkoc3FsLCB2YWx1ZSwgKGVyciwgcmVzdWx0LCBmaWVsZHMpID0+IHtcclxuICAgIGlmIChlcnIpIHRocm93IGVycjtcclxuICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgfSk7XHJcblxyXG4gIC8vY2hhdCDtjIzsnbzsnYQg66CM642U66eB7ZWY7JesIO2VtOuLuSDtjIzsnbzsl5DshJwgdGl0bGUg67OA7IiY66W8IOyCrOyaqe2VoCDsiJgg7J6I7J2MXHJcbiAgcmVzLnJlbmRlcihcInZpZGVvXCIpO1xyXG59KTtcclxuXHJcbmFwcC5wb3N0KFwiL3ZpZGVvSW5kZXgvbGVhdmUtcm9vbVwiLCAocmVxLCByZXMpID0+IHtcclxuICBjb25zdCB7IHRpdGxlLCBhdXRoIH0gPSByZXEuYm9keTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy90aXRsZSA6XCIgKyB0aXRsZSk7XHJcbiAgY29uc29sZS5sb2coXCJhcHAuanMvYXV0aCA6XCIgKyBhdXRoKTtcclxuICBsZXQgeyByb29tcyB9ID0gYXBwLmdldChcImR1bW15RGIyXCIpO1xyXG4gIGNvbnNvbGUubG9nKHJvb21zKTtcclxuICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG5cclxuICAvLyByb29tcy50b3RhbENvdW50ICs9IGNvdW50O1xyXG4gIC8vIGNvbnNvbGUubG9nKFwidG90YWxDb3VudCA6IFwiICsgdG90YWxDb3VudCk7XHJcblxyXG4gIGNvbnN0IGZvdW5kUm9vbSA9IHJvb21zLmZpbmQoKHJvb20pID0+IHJvb20udGl0bGUgPT09IHRpdGxlKTtcclxuICBjb25zb2xlLmxvZyhcImFwcC5qcy9mb3VuZFJvb20udG90YWxDb3VudCA6XCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcblxyXG4gIGlmIChmb3VuZFJvb20pIHtcclxuICAgIGlmIChhdXRoID09IDEpIHtcclxuICAgICAgZm91bmRSb29tLnRvdGFsQ291bnQgLT0gMTtcclxuICAgICAgY29uc29sZS5sb2coXCJhcHAuanMvdG90YWxDb3VudDExMSA6IFwiICsgZm91bmRSb29tLnRvdGFsQ291bnQpO1xyXG4gICAgfSBlbHNlIGlmIChhdXRoID09IDApIHtcclxuICAgICAgZm91bmRSb29tLnRvdGFsQ291bnQgPSAwO1xyXG4gICAgICBjb25zb2xlLmxvZyhcImFwcC5qcy90b3RhbENvdW50MTExIDogXCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZvdW5kUm9vbS50b3RhbENvdW50ID09IDApIHtcclxuICAgICAgY29uc3QgaW5kZXggPSByb29tcy5pbmRleE9mKGZvdW5kUm9vbSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiYXBwLmpzL2luZGV4IDogXCIgKyBpbmRleCk7XHJcbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICByb29tcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBjb25zdCBzcWwgPVxyXG4gICAgICAgICAgXCJVUERBVEUgY2hhdCBTRVQgY2hhdHRpbmdfY2xvc2VkPW5vdygpIFdIRVJFIGNoYXRfdGl0bGUgPSA/XCI7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBbdGl0bGVdO1xyXG5cclxuICAgICAgICBjb25uLnF1ZXJ5KHNxbCwgdmFsdWUsIChlcnIsIHJlc3VsdCwgZmllbGRzKSA9PiB7XHJcbiAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnI7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcImFwcC5qcy90b3RhbENvdW50MjIyIDogXCIgKyBmb3VuZFJvb20udG90YWxDb3VudCk7XHJcbiAgICBjb25zb2xlLmxvZyhyb29tcyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzLnJlbmRlcihcInZpZGVvSW5kZXhcIiwgeyByb29tcyB9KTtcclxufSk7XHJcblxyXG4vLyoqKioqKioqKioqKioqIO2ZlOyDgSDrgZ0gKioqKioqKioqKioqKiovXHJcblxyXG5hcHAudXNlKChlcnIsIHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgcmVzLmxvY2Fscy5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XHJcbiAgcmVzLmxvY2Fscy5lcnJvciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcIiBwcm9kdWN0aW9uXCIgPyBlcnIgOiB7fTtcclxuICByZXMuc3RhdHVzKGVyci5zdGF0dXMgfHwgNTAwKS5yZW5kZXIoXCJlcnJvclwiKTtcclxufSk7XHJcblxyXG5jb25zdCBleHByZXNzU2VydmVyID0gYXBwLmxpc3RlbihhcHAuZ2V0KFwicG9ydFwiKSwgKCkgPT5cclxuICBjb25zb2xlLmxvZyhgTGlzdGVuaW5nIG9uIGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMGApXHJcbik7XHJcblxyXG4vLyBzb2NrZXRcclxucmVxdWlyZShcIi4vc29ja2V0XCIpKGV4cHJlc3NTZXJ2ZXIsIGFwcCk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsSUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsaUJBQWlCLENBQUM7QUFDMUMsSUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsT0FBTyxDQUFDO0FBQzlCLElBQU1HLElBQUksR0FBR0gsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUU1QixJQUFNSSxJQUFJLEdBQUdGLEtBQUssQ0FBQ0csZ0JBQWdCLENBQUM7RUFDbENDLElBQUksRUFBRSxpQkFBaUI7RUFDdkJDLElBQUksRUFBRSxJQUFJO0VBQ1ZDLElBQUksRUFBRSxHQUFHO0VBQ1RDLFFBQVEsRUFBRSxHQUFHO0VBQ2JDLFFBQVEsRUFBRTtBQUNaLENBQUMsQ0FBQztBQUVGTixJQUFJLENBQUNPLE9BQU8sQ0FBQyxVQUFDQyxHQUFHLEVBQUs7RUFDcEIsSUFBSUEsR0FBRyxFQUFFO0lBQ1BDLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLGFBQWEsQ0FBQztJ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","map":{"version":3,"names":["express","require","session","mysql","cors","conn","createConnection","host","port","user","password","database","connect","err","console","error","log","app","set","process","env","PORT","__dirname","use","json","urlencoded","extended","corsOptions","origin","methods","credentials","resave","saveUninitialized","secret","COOKIE_SECRET","cookie","httpOnly","secure","req","res","next","header","rooms","Array","get","render","post","_req$body","body","title","auth","roomId","sessionID","Date","now","totalCount","_app$get","push","sql","value","query","result","fields","clients","forEach","client","location","readyState","OPEN","send","JSON","stringify","redirect","concat","_app$get$rooms$find","find","room","params","locals","targetRoom","_req$body2","_app$get2","foundRoom","index","indexOf","splice","_req$body3","_app$get3","_app$get$rooms$find2","_req$body4","_app$get4","message","NODE_ENV","status","expressServer","listen"],"sourceRoot":"D:\\Final_Project\\src\\open-chats\\","sources":["app.js"],"sourcesContent":["const express = require(\"express\");\r\nconst session = require(\"express-session\");\r\nconst mysql = require(\"mysql\");\r\nconst cors = require(\"cors\");\r\n\r\nconst conn = mysql.createConnection({\r\n  host: \"175.198.206.137\",\r\n  port: 3306,\r\n  user: \"q\",\r\n  password: \"q\",\r\n  database: \"follaw\",\r\n});\r\n\r\nconn.connect((err) => {\r\n  if (err) {\r\n    console.error(\"MySQL 연결 오류\");\r\n    return;\r\n  }\r\n  console.log(\"MySQL에 성공적으로 연결되었습니다.\");\r\n});\r\n\r\nconst app = express();\r\napp.set(\"port\", process.env.PORT || 3000);\r\napp.set(\"views\", __dirname + \"/views\");\r\napp.set(\"view engine\", \"pug\");\r\napp.use(\"/public\", express.static(__dirname + \"/public\"));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\n\r\nconst corsOptions = {\r\n  origin: \"http://your-client-domain:your-client-port\",\r\n  methods: \"GET,HEAD,PUT,PATCH,POST,DELETE\",\r\n  credentials: true,\r\n};\r\n\r\napp.use(cors(corsOptions));\r\n\r\napp.use(\r\n  session({\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    //COOKIE_SECRET 환경 변수가 설정되어 있다면 그 값을 사용하고,\r\n    //설정되어 있지 않다면 \"secret\"이라는 기본값을 사용하여 세션 데이터를 암호화\r\n    secret: process.env.COOKIE_SECRET || \"secret\",\r\n    cookie: {\r\n      //httpOnly: true는 클라이언트에서 세션 쿠키에 접근할 때 JavaScript를 통한 접근을 막는 옵션\r\n      httpOnly: true,\r\n      //secure: false는 세션 쿠키를 안전한 연결(HTTPS)을 통해서만 전송해야 하는지 여부를 설정하는 옵션\r\n      secure: false,\r\n    },\r\n  })\r\n);\r\napp.use((req, res, next) => {\r\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n  res.header(\r\n    \"Access-Control-Allow-Headers\",\r\n    \"Origin, X-Requested-With, Content-Type, Accept\"\r\n  );\r\n  next();\r\n});\r\n\r\n//************** 채팅 시작 **************/\r\napp.set(\"dummyDb\", { rooms: new Array() });\r\n\r\napp.get(\"/\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"index\");\r\n});\r\n\r\napp.post(\"/\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"index\");\r\n});\r\n\r\napp.post(\"/newRoom\", (req, res) => {\r\n  const { title, auth, user } = req.body;\r\n  const roomId = req.sessionID + Date.now();\r\n  let totalCount = 0;\r\n  const { rooms } = app.get(\"dummyDb\");\r\n\r\n  if (auth == 0) {\r\n    totalCount += 1;\r\n  }\r\n\r\n  console.log(\"app.js / user :\" + user);\r\n\r\n  rooms.push({ title, roomId, totalCount });\r\n  console.log(\"app.js / newRoom >>> title : \" + title);\r\n\r\n  const sql =\r\n    \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(0, ?, ?, now())\";\r\n  const value = [title, user];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  // 채팅방 새로 생성시 홈에 있는 사람들에게 새로은 방 목록 전송\r\n  // Q?: 본인은 왜 제외될까?\r\n  // A!: 나는 현재 연결된 소켓이 없는상태임 home에서 newroom 으로 갈때 connection이 끊어지고\r\n  //     redirect로 /chat/:roomId로 보내져야 chat.js에서 connection을 연결함\r\n  app.get(\"wss\").clients.forEach((client) => {\r\n    if (client.location === \"index\" && client.readyState === client.OPEN)\r\n      client.send(JSON.stringify(rooms));\r\n  });\r\n  return res.redirect(`/chat/${roomId}`);\r\n});\r\n\r\napp.get(\"/chat/:roomId\", (req, res) => {\r\n  const { user } = req.query;\r\n  console.log(\"/chat/:roomId >>> user : \" + user);\r\n  const { title } = app\r\n    .get(\"dummyDb\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\r\n  console.log(\"app.js/title :\" + title);\r\n  res.locals.title = title;\r\n\r\n  const targetRoom = app\r\n    .get(\"dummyDb\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\r\n  targetRoom.totalCount += 1;\r\n\r\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\r\n\r\n  const sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\r\n  const value = [user, title];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\r\n  res.render(\"chat\");\r\n});\r\n\r\n// let totalCount = 0;\r\n\r\napp.post(\"/leave-room\", (req, res) => {\r\n  const { title, auth } = req.body;\r\n  console.log(\"app.js/title :\" + title);\r\n  console.log(\"app.js/auth :\" + auth);\r\n  let { rooms } = app.get(\"dummyDb\");\r\n  console.log(rooms);\r\n  console.log(\"--------------------\");\r\n\r\n  // rooms.totalCount += count;\r\n  // console.log(\"totalCount : \" + totalCount);\r\n\r\n  const foundRoom = rooms.find((room) => room.title === title);\r\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\r\n\r\n  if (foundRoom) {\r\n    if (auth == 1) {\r\n      foundRoom.totalCount -= 1;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    } else if (auth == 0) {\r\n      foundRoom.totalCount = 0;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    }\r\n\r\n    if (foundRoom.totalCount == 0) {\r\n      const index = rooms.indexOf(foundRoom);\r\n      console.log(\"app.js/index : \" + index);\r\n      if (index !== -1) {\r\n        rooms.splice(index, 1);\r\n\r\n        const sql =\r\n          \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\r\n        const value = [title];\r\n\r\n        conn.query(sql, value, (err, result, fields) => {\r\n          if (err) throw err;\r\n          console.log(result);\r\n        });\r\n      }\r\n    }\r\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\r\n    console.log(rooms);\r\n  }\r\n\r\n  return res.render(\"index\", { rooms });\r\n});\r\n\r\n//************** 채팅 끝 **************/\r\n\r\n//************** 화상 시작 **************/\r\napp.set(\"dummyDb2\", { rooms: new Array() });\r\n\r\napp.get(\"/videoIndex\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"videoIndex\");\r\n});\r\n\r\napp.post(\"/videoIndex\", (req, res) => {\r\n  // TODO: add user\r\n  return res.render(\"videoIndex\");\r\n});\r\n\r\napp.post(\"/videoIndex/newRoom\", (req, res) => {\r\n  const { title, auth, user } = req.body;\r\n  const roomId = req.sessionID + Date.now();\r\n  let totalCount = 0;\r\n  const { rooms } = app.get(\"dummyDb2\");\r\n\r\n  if (auth == 0) {\r\n    totalCount += 1;\r\n  }\r\n\r\n  console.log(\"app.js / user :\" + user);\r\n\r\n  rooms.push({ title, roomId, totalCount });\r\n  console.log(\"app.js / newRoom : \" + rooms);\r\n\r\n  const sql =\r\n    \"INSERT INTO chat(chat_type, chat_title, user_id, chat_created) VALUES(1, ?, ?, now())\";\r\n  const value = [title, user];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  // 채팅방 새로 생성시 홈에 있는 사람들에게 새로은 방 목록 전송\r\n  // Q?: 본인은 왜 제외될까?\r\n  // A!: 나는 현재 연결된 소켓이 없는상태임 home에서 newroom 으로 갈때 connection이 끊어지고\r\n  //     redirect로 /chat/:roomId로 보내져야 chat.js에서 connection을 연결함\r\n  app.get(\"wss\").clients.forEach((client) => {\r\n    if (client.location === \"videoIndex\" && client.readyState === client.OPEN)\r\n      client.send(JSON.stringify(rooms));\r\n  });\r\n  return res.redirect(`/video/${roomId}`);\r\n});\r\n\r\napp.get(\"/video/:roomId\", (req, res) => {\r\n  const { user } = req.query;\r\n  console.log(\"/video/:roomId  >>> user : \" + user);\r\n  const { title } = app\r\n    .get(\"dummyDb2\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  //res.locals는 응답 객체(res)의 속성으로, 해당 응답에 대한 로컬 변수를 설정하고 사용할 수 있게 해줌\r\n  console.log(\"app.js/title :\" + title);\r\n  res.locals.title = title;\r\n\r\n  const targetRoom = app\r\n    .get(\"dummyDb2\")\r\n    .rooms.find((room) => room.roomId === req.params.roomId);\r\n\r\n  console.log(\"app.js/targetRoom1 :\" + targetRoom.totalCount);\r\n  targetRoom.totalCount += 1;\r\n\r\n  console.log(\"app.js/targetRoom2 :\" + targetRoom.totalCount);\r\n\r\n  const sql = \"UPDATE chat SET lawyer_id=? WHERE chat_title = ?\";\r\n  const value = [user, title];\r\n\r\n  conn.query(sql, value, (err, result, fields) => {\r\n    if (err) throw err;\r\n    console.log(result);\r\n  });\r\n\r\n  //chat 파일을 렌더링하여 해당 파일에서 title 변수를 사용할 수 있음\r\n  res.render(\"video\");\r\n});\r\n\r\napp.post(\"/videoIndex/leave-room\", (req, res) => {\r\n  const { title, auth } = req.body;\r\n  console.log(\"app.js/title :\" + title);\r\n  console.log(\"app.js/auth :\" + auth);\r\n  let { rooms } = app.get(\"dummyDb2\");\r\n  console.log(rooms);\r\n  console.log(\"--------------------\");\r\n\r\n  // rooms.totalCount += count;\r\n  // console.log(\"totalCount : \" + totalCount);\r\n\r\n  const foundRoom = rooms.find((room) => room.title === title);\r\n  console.log(\"app.js/foundRoom.totalCount :\" + foundRoom.totalCount);\r\n\r\n  if (foundRoom) {\r\n    if (auth == 1) {\r\n      foundRoom.totalCount -= 1;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    } else if (auth == 0) {\r\n      foundRoom.totalCount = 0;\r\n      console.log(\"app.js/totalCount111 : \" + foundRoom.totalCount);\r\n    }\r\n\r\n    if (foundRoom.totalCount == 0) {\r\n      const index = rooms.indexOf(foundRoom);\r\n      console.log(\"app.js/index : \" + index);\r\n      if (index !== -1) {\r\n        rooms.splice(index, 1);\r\n\r\n        const sql =\r\n          \"UPDATE chat SET chatting_closed=now() WHERE chat_title = ?\";\r\n        const value = [title];\r\n\r\n        conn.query(sql, value, (err, result, fields) => {\r\n          if (err) throw err;\r\n          console.log(result);\r\n        });\r\n      }\r\n    }\r\n    console.log(\"app.js/totalCount222 : \" + foundRoom.totalCount);\r\n    console.log(rooms);\r\n  }\r\n\r\n  return res.render(\"videoIndex\", { rooms });\r\n});\r\n\r\n//************** 화상 끝 **************/\r\n\r\napp.use((err, req, res, next) => {\r\n  res.locals.message = err.message;\r\n  res.locals.error = process.env.NODE_ENV !== \" production\" ? err : {};\r\n  res.status(err.status || 500).render(\"error\");\r\n});\r\n\r\nconst expressServer = app.listen(app.get(\"port\"), () =>\r\n  console.log(`Listening on http://localhost:3000`)\r\n);\r\n\r\n// socket\r\nrequire(\"./socket\")(expressServer, app);\r\n"],"mappings":"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"}},"mtime":1706247641457},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\socket.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nvar ws = require(\"ws\");\n\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\nmodule.exports = function (server, app) {\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\n  var wss = new ws.Server({\n    server: server\n  });\n  // for sending a rooms data when a new room is created\n  // used at app.post('newroom') on app.js\n  app.set(\"wss\", wss);\n\n  // Backend에서 socket을 사용할 준비 완료\n  wss.on(\"connection\", function (ws, req) {\n    console.log(\"WebSocket connected to: \" + req.url);\n    if (req.url === \"/rooms\") {\n      ws.location = \"index\";\n      // get a data when into index\n      ws.send(JSON.stringify(app.get(\"dummyDb\").rooms));\n    } else if (req.url.startsWith(\"/chat/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      ws.on(\"message\", function (message) {\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        wss.clients.forEach(function (client) {\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location) client.send(message.toString());\n          // send message to\n          // open sockets (client.readyState === ws.OPEN)\n          // in my room (client.roomId === ws.roomId)\n          // without me (client !== ws)\n        });\n      });\n    } else if (req.url === \"/videoIndex\") {\n      ws.location = \"videoIndex\";\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\n    } else if (req.url.startsWith(\"/video/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      console.log(\"socket >>> ws.location : \" + ws.location);\n      ws.on(\"message\", function (message) {\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        wss.clients.forEach(function (client) {\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location) {\n            client.send(message.toString());\n          }\n          // send message to\n          // open sockets (client.readyState === ws.OPEN)\n          // in my room (client.roomId === ws.roomId)\n          // without me (client !== ws)\n        });\n      });\n    }\n    ws.on(\"createRoom\", function (roomId, userA) {\n      console.log(\"Joining Room(171) : \", roomId);\n      ws.to(roomId).send(\"userConnected\", roomId, userA);\n    });\n    ws.on(\"error\", function (error) {\n      console.error(error);\n      app.locals.message = error.message;\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\n      app.render(\"error\");\n    });\n    ws.on(\"close\", function () {\n      return console.log(\"\".concat(req.url, \" connection close\"));\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3cyIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwic2VydmVyIiwiYXBwIiwid3NzIiwiU2VydmVyIiwic2V0Iiwib24iLCJyZXEiLCJjb25zb2xlIiwibG9nIiwidXJsIiwibG9jYXRpb24iLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldCIsInJvb21zIiwic3RhcnRzV2l0aCIsInNwbGl0IiwibWVzc2FnZSIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJ0b1N0cmluZyIsInJvb21JZCIsInVzZXJBIiwidG8iLCJlcnJvciIsImxvY2FscyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInJlbmRlciIsImNvbmNhdCJdLCJzb3VyY2VSb290IjoiRDpcXEZpbmFsX1Byb2plY3RcXHNyY1xcb3Blbi1jaGF0c1xcIiwic291cmNlcyI6WyJzb2NrZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd3MgPSByZXF1aXJlKFwid3NcIik7XHJcblxyXG4vL21vZHVsZS5leHBvcnRzIDog66qo65OI7J2EIOuCtOuztOuCtOuKlCDrjbAg7IKs7Jqp65CY64qUIO2KueyImO2VnCDqsJ3ssrRcclxuLy/ri6Trpbgg7YyM7J287JeQ7IScIO2VtOuLuSDrqqjrk4jsnYQg6rCA7KC47JmAIOyCrOyaqSDqsIDriqUocmVxdWlyZSgpIOydtOyaqSlcclxubW9kdWxlLmV4cG9ydHMgPSAoc2VydmVyLCBhcHApID0+IHtcclxuICAvL3dzIOuqqOuTiOydmCBTZXJ2ZXIg7YG0656Y7IqkKFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY6rOgIOq0gOumrCnrpbwg7IKs7Jqp7ZWY7JesIFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY64qUIOq1rOusuFxyXG4gIGNvbnN0IHdzcyA9IG5ldyB3cy5TZXJ2ZXIoeyBzZXJ2ZXIgfSk7XHJcbiAgLy8gZm9yIHNlbmRpbmcgYSByb29tcyBkYXRhIHdoZW4gYSBuZXcgcm9vbSBpcyBjcmVhdGVkXHJcbiAgLy8gdXNlZCBhdCBhcHAucG9zdCgnbmV3cm9vbScpIG9uIGFwcC5qc1xyXG4gIGFwcC5zZXQoXCJ3c3NcIiwgd3NzKTtcclxuXHJcbiAgLy8gQmFja2VuZOyXkOyEnCBzb2NrZXTsnYQg7IKs7Jqp7ZWgIOykgOu5hCDsmYTro4xcclxuICB3c3Mub24oXCJjb25uZWN0aW9uXCIsICh3cywgcmVxKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIldlYlNvY2tldCBjb25uZWN0ZWQgdG86IFwiICsgcmVxLnVybCk7XHJcbiAgICBpZiAocmVxLnVybCA9PT0gXCIvcm9vbXNcIikge1xyXG4gICAgICB3cy5sb2NhdGlvbiA9IFwiaW5kZXhcIjtcclxuICAgICAgLy8gZ2V0IGEgZGF0YSB3aGVuIGludG8gaW5kZXhcclxuICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeShhcHAuZ2V0KFwiZHVtbXlEYlwiKS5yb29tcykpO1xyXG4gICAgfSBlbHNlIGlmIChyZXEudXJsLnN0YXJ0c1dpdGgoXCIvY2hhdC9cIikpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSByZXEudXJsLnNwbGl0KFwiL1wiKVsyXTtcclxuICAgICAgd3Mub24oXCJtZXNzYWdlXCIsIChtZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgLy8gc2VuZCBtZXNzYWdlIHRvIG9wZW4gc29ja2V0cyBpbiBteSByb29tIHdpdGhvdXQgbWVcclxuICAgICAgICAvL+2BtOudvOydtOyWuO2KuOqwgCDtmITsnqwg66mU7Iuc7KeA66W8IOuztOuCuCDtgbTrnbzsnbTslrjtirgod3Mp7JmAIOqwmeyngCDslYrqs6AsXHJcbiAgICAgICAgLy/sg4Htg5zqsIAgT1BFTuyduCDqsr3smrAsIOq3uOumrOqzoCDqsJnsnYAg67CpKGxvY2F0aW9uKeyXkCDsnojripQg6rK97Jqw7JeQ66eMIOuplOyEuOyngCDsoITshqFcclxuICAgICAgICB3c3MuY2xpZW50cy5mb3JFYWNoKChjbGllbnQpID0+IHtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgY2xpZW50ICE9PSB3cyAmJlxyXG4gICAgICAgICAgICBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJlxyXG4gICAgICAgICAgICBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAvLyBzZW5kIG1lc3NhZ2UgdG9cclxuICAgICAgICAgIC8vIG9wZW4gc29ja2V0cyAoY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4pXHJcbiAgICAgICAgICAvLyBpbiBteSByb29tIChjbGllbnQucm9vbUlkID09PSB3cy5yb29tSWQpXHJcbiAgICAgICAgICAvLyB3aXRob3V0IG1lIChjbGllbnQgIT09IHdzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAocmVxLnVybCA9PT0gXCIvdmlkZW9JbmRleFwiKSB7XHJcbiAgICAgIHdzLmxvY2F0aW9uID0gXCJ2aWRlb0luZGV4XCI7XHJcbiAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoYXBwLmdldChcImR1bW15RGIyXCIpLnJvb21zKSk7XHJcbiAgICB9IGVsc2UgaWYgKHJlcS51cmwuc3RhcnRzV2l0aChcIi92aWRlby9cIikpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSByZXEudXJsLnNwbGl0KFwiL1wiKVsyXTtcclxuICAgICAgY29uc29sZS5sb2coXCJzb2NrZXQgPj4+IHdzLmxvY2F0aW9uIDogXCIgKyB3cy5sb2NhdGlvbik7XHJcbiAgICAgIHdzLm9uKFwibWVzc2FnZVwiLCAobWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIC8vIHNlbmQgbWVzc2FnZSB0byBvcGVuIHNvY2tldHMgaW4gbXkgcm9vbSB3aXRob3V0IG1lXHJcbiAgICAgICAgLy/tgbTrnbzsnbTslrjtirjqsIAg7ZiE7J6sIOuplOyLnOyngOulvCDrs7Trgrgg7YG065287J207Ja47Yq4KHdzKeyZgCDqsJnsp4Ag7JWK6rOgLFxyXG4gICAgICAgIC8v7IOB7YOc6rCAIE9QRU7snbgg6rK97JqwLCDqt7jrpqzqs6Ag6rCZ7J2AIOuwqShsb2NhdGlvbinsl5Ag7J6I64qUIOqyveyasOyXkOunjCDrqZTshLjsp4Ag7KCE7IahXHJcbiAgICAgICAgd3NzLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGNsaWVudCAhPT0gd3MgJiZcclxuICAgICAgICAgICAgY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4gJiZcclxuICAgICAgICAgICAgY2xpZW50LmxvY2F0aW9uID09PSB3cy5sb2NhdGlvblxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBzZW5kIG1lc3NhZ2UgdG9cclxuICAgICAgICAgIC8vIG9wZW4gc29ja2V0cyAoY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4pXHJcbiAgICAgICAgICAvLyBpbiBteSByb29tIChjbGllbnQucm9vbUlkID09PSB3cy5yb29tSWQpXHJcbiAgICAgICAgICAvLyB3aXRob3V0IG1lIChjbGllbnQgIT09IHdzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB3cy5vbihcImNyZWF0ZVJvb21cIiwgKHJvb21JZCwgdXNlckEpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJKb2luaW5nIFJvb20oMTcxKSA6IFwiLCByb29tSWQpO1xyXG4gICAgICB3cy50byhyb29tSWQpLnNlbmQoXCJ1c2VyQ29ubmVjdGVkXCIsIHJvb21JZCwgdXNlckEpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd3Mub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgIGFwcC5sb2NhbHMubWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XHJcbiAgICAgIGFwcC5sb2NhbHMuZXJyb3IgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCIgcHJvZHVjdGlvblwiID8gZXJyb3IgOiB7fTtcclxuICAgICAgYXBwLnJlbmRlcihcImVycm9yXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd3Mub24oXCJjbG9zZVwiLCAoKSA9PiBjb25zb2xlLmxvZyhgJHtyZXEudXJsfSBjb25uZWN0aW9uIGNsb3NlYCkpO1xyXG4gIH0pO1xyXG59O1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDOztBQUV4QjtBQUNBO0FBQ0FDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLFVBQUNDLE1BQU0sRUFBRUMsR0FBRyxFQUFLO0VBQ2hDO0VBQ0EsSUFBTUMsR0FBRyxHQUFHLElBQUlOLEVBQUUsQ0FBQ08sTUFBTSxDQUFDO0lBQUVILE1BQU0sRUFBTkE7RUFBTyxDQUFDLENBQUM7RUFDckM7RUFDQTtFQUNBQyxHQUFHLENBQUNHLEdBQUcsQ0FBQyxLQUFLLEVBQUVGLEdBQUcsQ0FBQzs7RUFFbkI7RUFDQUEsR0FBRyxDQUFDRyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQUNULEVBQUUsRUFBRVUsR0FBRyxFQUFLO0lBQ2hDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQywwQkFBMEIsR0FBR0YsR0FBRyxDQUFDRyxHQUFHLENBQUM7SUFDakQsSUFBSUgsR0FBRyxDQUFDRyxHQUFHLEtBQUssUUFBUSxFQUFFO01BQ3hCYixFQUFFLENBQUNjLFFBQVEsR0FBRyxPQUFPO01BQ3JCO01BQ0FkLEVBQUUsQ0FBQ2UsSUFBSSxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ1osR0FBRyxDQUFDYSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUNDLEtBQUssQ0FBQyxDQUFDO0lBQ25ELENBQUMsTUFBTSxJQUFJVCxHQUFHLENBQUNHLEdBQUcs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","map":{"version":3,"names":["ws","require","module","exports","server","app","wss","Server","set","on","req","console","log","url","location","send","JSON","stringify","get","rooms","startsWith","split","message","clients","forEach","client","readyState","OPEN","toString","roomId","userA","to","error","locals","process","env","NODE_ENV","render","concat"],"sourceRoot":"D:\\Final_Project\\src\\open-chats\\","sources":["socket.js"],"sourcesContent":["const ws = require(\"ws\");\r\n\r\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\r\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\r\nmodule.exports = (server, app) => {\r\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\r\n  const wss = new ws.Server({ server });\r\n  // for sending a rooms data when a new room is created\r\n  // used at app.post('newroom') on app.js\r\n  app.set(\"wss\", wss);\r\n\r\n  // Backend에서 socket을 사용할 준비 완료\r\n  wss.on(\"connection\", (ws, req) => {\r\n    console.log(\"WebSocket connected to: \" + req.url);\r\n    if (req.url === \"/rooms\") {\r\n      ws.location = \"index\";\r\n      // get a data when into index\r\n      ws.send(JSON.stringify(app.get(\"dummyDb\").rooms));\r\n    } else if (req.url.startsWith(\"/chat/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      ws.on(\"message\", (message) => {\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        wss.clients.forEach((client) => {\r\n          if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location\r\n          )\r\n            client.send(message.toString());\r\n          // send message to\r\n          // open sockets (client.readyState === ws.OPEN)\r\n          // in my room (client.roomId === ws.roomId)\r\n          // without me (client !== ws)\r\n        });\r\n      });\r\n    } else if (req.url === \"/videoIndex\") {\r\n      ws.location = \"videoIndex\";\r\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\r\n    } else if (req.url.startsWith(\"/video/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      console.log(\"socket >>> ws.location : \" + ws.location);\r\n      ws.on(\"message\", (message) => {\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        wss.clients.forEach((client) => {\r\n          if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location\r\n          ) {\r\n            client.send(message.toString());\r\n          }\r\n          // send message to\r\n          // open sockets (client.readyState === ws.OPEN)\r\n          // in my room (client.roomId === ws.roomId)\r\n          // without me (client !== ws)\r\n        });\r\n      });\r\n    }\r\n\r\n    ws.on(\"createRoom\", (roomId, userA) => {\r\n      console.log(\"Joining Room(171) : \", roomId);\r\n      ws.to(roomId).send(\"userConnected\", roomId, userA);\r\n    });\r\n\r\n    ws.on(\"error\", (error) => {\r\n      console.error(error);\r\n      app.locals.message = error.message;\r\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\r\n      app.render(\"error\");\r\n    });\r\n\r\n    ws.on(\"close\", () => console.log(`${req.url} connection close`));\r\n  });\r\n};\r\n"],"mappings":"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"}},"mtime":1706247641460},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\Final_Project\",\"filename\":\"D:\\\\Final_Project\\\\src\\\\open-chats\\\\socket.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\Final_Project\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.23.9:development":{"value":{"code":"\"use strict\";\n\nvar ws = require(\"ws\");\n\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\nmodule.exports = function (server, app) {\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\n  var wss = new ws.Server({\n    server: server\n  });\n  // for sending a rooms data when a new room is created\n  // used at app.post('newroom') on app.js\n  app.set(\"wss\", wss);\n\n  // Backend에서 socket을 사용할 준비 완료\n  wss.on(\"connection\", function (ws, req) {\n    console.log(\"WebSocket connected to: \" + req.url);\n    if (req.url === \"/rooms\") {\n      ws.location = \"index\";\n      // get a data when into index\n      ws.send(JSON.stringify(app.get(\"dummyDb\").rooms));\n    } else if (req.url.startsWith(\"/chat/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      ws.on(\"message\", function (message) {\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        wss.clients.forEach(function (client) {\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location) client.send(message.toString());\n          // send message to\n          // open sockets (client.readyState === ws.OPEN)\n          // in my room (client.roomId === ws.roomId)\n          // without me (client !== ws)\n        });\n      });\n    } else if (req.url === \"/videoIndex\") {\n      ws.location = \"videoIndex\";\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\n    } else if (req.url.startsWith(\"/video/\")) {\n      ws.location = req.url.split(\"/\")[2];\n      console.log(\"socket >>> ws.location : \" + ws.location);\n      ws.on(\"message\", function (message) {\n        // send message to open sockets in my room without me\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\n        wss.clients.forEach(function (client) {\n          if (client !== ws && client.readyState === ws.OPEN && client.location === ws.location) {\n            client.send(message.toString());\n          }\n          // send message to\n          // open sockets (client.readyState === ws.OPEN)\n          // in my room (client.roomId === ws.roomId)\n          // without me (client !== ws)\n        });\n      });\n    }\n    ws.on(\"createRoom\", function (roomId, userA) {\n      console.log(\"Joining Room(171) : \", roomId);\n      ws.to(roomId).send(\"userConnected\", roomId, userA);\n    });\n    ws.on(\"error\", function (error) {\n      console.error(error);\n      app.locals.message = error.message;\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\n      app.render(\"error\");\n    });\n    ws.on(\"close\", function () {\n      return console.log(\"\".concat(req.url, \" connection close\"));\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3cyIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwic2VydmVyIiwiYXBwIiwid3NzIiwiU2VydmVyIiwic2V0Iiwib24iLCJyZXEiLCJjb25zb2xlIiwibG9nIiwidXJsIiwibG9jYXRpb24iLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldCIsInJvb21zIiwic3RhcnRzV2l0aCIsInNwbGl0IiwibWVzc2FnZSIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJ0b1N0cmluZyIsInJvb21JZCIsInVzZXJBIiwidG8iLCJlcnJvciIsImxvY2FscyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInJlbmRlciIsImNvbmNhdCJdLCJzb3VyY2VSb290IjoiRDpcXEZpbmFsX1Byb2plY3RcXHNyY1xcb3Blbi1jaGF0c1xcIiwic291cmNlcyI6WyJzb2NrZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd3MgPSByZXF1aXJlKFwid3NcIik7XHJcblxyXG4vL21vZHVsZS5leHBvcnRzIDog66qo65OI7J2EIOuCtOuztOuCtOuKlCDrjbAg7IKs7Jqp65CY64qUIO2KueyImO2VnCDqsJ3ssrRcclxuLy/ri6Trpbgg7YyM7J287JeQ7IScIO2VtOuLuSDrqqjrk4jsnYQg6rCA7KC47JmAIOyCrOyaqSDqsIDriqUocmVxdWlyZSgpIOydtOyaqSlcclxubW9kdWxlLmV4cG9ydHMgPSAoc2VydmVyLCBhcHApID0+IHtcclxuICAvL3dzIOuqqOuTiOydmCBTZXJ2ZXIg7YG0656Y7IqkKFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY6rOgIOq0gOumrCnrpbwg7IKs7Jqp7ZWY7JesIFdlYlNvY2tldCDshJzrsoTrpbwg7IOd7ISx7ZWY64qUIOq1rOusuFxyXG4gIGNvbnN0IHdzcyA9IG5ldyB3cy5TZXJ2ZXIoeyBzZXJ2ZXIgfSk7XHJcbiAgLy8gZm9yIHNlbmRpbmcgYSByb29tcyBkYXRhIHdoZW4gYSBuZXcgcm9vbSBpcyBjcmVhdGVkXHJcbiAgLy8gdXNlZCBhdCBhcHAucG9zdCgnbmV3cm9vbScpIG9uIGFwcC5qc1xyXG4gIGFwcC5zZXQoXCJ3c3NcIiwgd3NzKTtcclxuXHJcbiAgLy8gQmFja2VuZOyXkOyEnCBzb2NrZXTsnYQg7IKs7Jqp7ZWgIOykgOu5hCDsmYTro4xcclxuICB3c3Mub24oXCJjb25uZWN0aW9uXCIsICh3cywgcmVxKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIldlYlNvY2tldCBjb25uZWN0ZWQgdG86IFwiICsgcmVxLnVybCk7XHJcbiAgICBpZiAocmVxLnVybCA9PT0gXCIvcm9vbXNcIikge1xyXG4gICAgICB3cy5sb2NhdGlvbiA9IFwiaW5kZXhcIjtcclxuICAgICAgLy8gZ2V0IGEgZGF0YSB3aGVuIGludG8gaW5kZXhcclxuICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeShhcHAuZ2V0KFwiZHVtbXlEYlwiKS5yb29tcykpO1xyXG4gICAgfSBlbHNlIGlmIChyZXEudXJsLnN0YXJ0c1dpdGgoXCIvY2hhdC9cIikpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSByZXEudXJsLnNwbGl0KFwiL1wiKVsyXTtcclxuICAgICAgd3Mub24oXCJtZXNzYWdlXCIsIChtZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgLy8gc2VuZCBtZXNzYWdlIHRvIG9wZW4gc29ja2V0cyBpbiBteSByb29tIHdpdGhvdXQgbWVcclxuICAgICAgICAvL+2BtOudvOydtOyWuO2KuOqwgCDtmITsnqwg66mU7Iuc7KeA66W8IOuztOuCuCDtgbTrnbzsnbTslrjtirgod3Mp7JmAIOqwmeyngCDslYrqs6AsXHJcbiAgICAgICAgLy/sg4Htg5zqsIAgT1BFTuyduCDqsr3smrAsIOq3uOumrOqzoCDqsJnsnYAg67CpKGxvY2F0aW9uKeyXkCDsnojripQg6rK97Jqw7JeQ66eMIOuplOyEuOyngCDsoITshqFcclxuICAgICAgICB3c3MuY2xpZW50cy5mb3JFYWNoKChjbGllbnQpID0+IHtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgY2xpZW50ICE9PSB3cyAmJlxyXG4gICAgICAgICAgICBjbGllbnQucmVhZHlTdGF0ZSA9PT0gd3MuT1BFTiAmJlxyXG4gICAgICAgICAgICBjbGllbnQubG9jYXRpb24gPT09IHdzLmxvY2F0aW9uXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAvLyBzZW5kIG1lc3NhZ2UgdG9cclxuICAgICAgICAgIC8vIG9wZW4gc29ja2V0cyAoY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4pXHJcbiAgICAgICAgICAvLyBpbiBteSByb29tIChjbGllbnQucm9vbUlkID09PSB3cy5yb29tSWQpXHJcbiAgICAgICAgICAvLyB3aXRob3V0IG1lIChjbGllbnQgIT09IHdzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAocmVxLnVybCA9PT0gXCIvdmlkZW9JbmRleFwiKSB7XHJcbiAgICAgIHdzLmxvY2F0aW9uID0gXCJ2aWRlb0luZGV4XCI7XHJcbiAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoYXBwLmdldChcImR1bW15RGIyXCIpLnJvb21zKSk7XHJcbiAgICB9IGVsc2UgaWYgKHJlcS51cmwuc3RhcnRzV2l0aChcIi92aWRlby9cIikpIHtcclxuICAgICAgd3MubG9jYXRpb24gPSByZXEudXJsLnNwbGl0KFwiL1wiKVsyXTtcclxuICAgICAgY29uc29sZS5sb2coXCJzb2NrZXQgPj4+IHdzLmxvY2F0aW9uIDogXCIgKyB3cy5sb2NhdGlvbik7XHJcbiAgICAgIHdzLm9uKFwibWVzc2FnZVwiLCAobWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIC8vIHNlbmQgbWVzc2FnZSB0byBvcGVuIHNvY2tldHMgaW4gbXkgcm9vbSB3aXRob3V0IG1lXHJcbiAgICAgICAgLy/tgbTrnbzsnbTslrjtirjqsIAg7ZiE7J6sIOuplOyLnOyngOulvCDrs7Trgrgg7YG065287J207Ja47Yq4KHdzKeyZgCDqsJnsp4Ag7JWK6rOgLFxyXG4gICAgICAgIC8v7IOB7YOc6rCAIE9QRU7snbgg6rK97JqwLCDqt7jrpqzqs6Ag6rCZ7J2AIOuwqShsb2NhdGlvbinsl5Ag7J6I64qUIOqyveyasOyXkOunjCDrqZTshLjsp4Ag7KCE7IahXHJcbiAgICAgICAgd3NzLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGNsaWVudCAhPT0gd3MgJiZcclxuICAgICAgICAgICAgY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4gJiZcclxuICAgICAgICAgICAgY2xpZW50LmxvY2F0aW9uID09PSB3cy5sb2NhdGlvblxyXG4gICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNsaWVudC5zZW5kKG1lc3NhZ2UudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyBzZW5kIG1lc3NhZ2UgdG9cclxuICAgICAgICAgIC8vIG9wZW4gc29ja2V0cyAoY2xpZW50LnJlYWR5U3RhdGUgPT09IHdzLk9QRU4pXHJcbiAgICAgICAgICAvLyBpbiBteSByb29tIChjbGllbnQucm9vbUlkID09PSB3cy5yb29tSWQpXHJcbiAgICAgICAgICAvLyB3aXRob3V0IG1lIChjbGllbnQgIT09IHdzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB3cy5vbihcImNyZWF0ZVJvb21cIiwgKHJvb21JZCwgdXNlckEpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJKb2luaW5nIFJvb20oMTcxKSA6IFwiLCByb29tSWQpO1xyXG4gICAgICB3cy50byhyb29tSWQpLnNlbmQoXCJ1c2VyQ29ubmVjdGVkXCIsIHJvb21JZCwgdXNlckEpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd3Mub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgIGFwcC5sb2NhbHMubWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XHJcbiAgICAgIGFwcC5sb2NhbHMuZXJyb3IgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCIgcHJvZHVjdGlvblwiID8gZXJyb3IgOiB7fTtcclxuICAgICAgYXBwLnJlbmRlcihcImVycm9yXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd3Mub24oXCJjbG9zZVwiLCAoKSA9PiBjb25zb2xlLmxvZyhgJHtyZXEudXJsfSBjb25uZWN0aW9uIGNsb3NlYCkpO1xyXG4gIH0pO1xyXG59O1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDOztBQUV4QjtBQUNBO0FBQ0FDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLFVBQUNDLE1BQU0sRUFBRUMsR0FBRyxFQUFLO0VBQ2hDO0VBQ0EsSUFBTUMsR0FBRyxHQUFHLElBQUlOLEVBQUUsQ0FBQ08sTUFBTSxDQUFDO0lBQUVILE1BQU0sRUFBTkE7RUFBTyxDQUFDLENBQUM7RUFDckM7RUFDQTtFQUNBQyxHQUFHLENBQUNHLEdBQUcsQ0FBQyxLQUFLLEVBQUVGLEdBQUcsQ0FBQzs7RUFFbkI7RUFDQUEsR0FBRyxDQUFDRyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQUNULEVBQUUsRUFBRVUsR0FBRyxFQUFLO0lBQ2hDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQywwQkFBMEIsR0FBR0YsR0FBRyxDQUFDRyxHQUFHLENBQUM7SUFDakQsSUFBSUgsR0FBRyxDQUFDRyxHQUFHLEtBQUssUUFBUSxFQUFFO01BQ3hCYixFQUFFLENBQUNjLFFBQVEsR0FBRyxPQUFPO01BQ3JCO01BQ0FkLEVBQUUsQ0FBQ2UsSUFBSSxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ1osR0FBRyxDQUFDYSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUNDLEtBQUssQ0FBQyxDQUFDO0lBQ25ELENBQUMsTUFBTSxJQUFJVCxHQUFHLENBQUNHLEdBQUcs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","map":{"version":3,"names":["ws","require","module","exports","server","app","wss","Server","set","on","req","console","log","url","location","send","JSON","stringify","get","rooms","startsWith","split","message","clients","forEach","client","readyState","OPEN","toString","roomId","userA","to","error","locals","process","env","NODE_ENV","render","concat"],"sourceRoot":"D:\\Final_Project\\src\\open-chats\\","sources":["socket.js"],"sourcesContent":["const ws = require(\"ws\");\r\n\r\n//module.exports : 모듈을 내보내는 데 사용되는 특수한 객체\r\n//다른 파일에서 해당 모듈을 가져와 사용 가능(require() 이용)\r\nmodule.exports = (server, app) => {\r\n  //ws 모듈의 Server 클래스(WebSocket 서버를 생성하고 관리)를 사용하여 WebSocket 서버를 생성하는 구문\r\n  const wss = new ws.Server({ server });\r\n  // for sending a rooms data when a new room is created\r\n  // used at app.post('newroom') on app.js\r\n  app.set(\"wss\", wss);\r\n\r\n  // Backend에서 socket을 사용할 준비 완료\r\n  wss.on(\"connection\", (ws, req) => {\r\n    console.log(\"WebSocket connected to: \" + req.url);\r\n    if (req.url === \"/rooms\") {\r\n      ws.location = \"index\";\r\n      // get a data when into index\r\n      ws.send(JSON.stringify(app.get(\"dummyDb\").rooms));\r\n    } else if (req.url.startsWith(\"/chat/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      ws.on(\"message\", (message) => {\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        wss.clients.forEach((client) => {\r\n          if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location\r\n          )\r\n            client.send(message.toString());\r\n          // send message to\r\n          // open sockets (client.readyState === ws.OPEN)\r\n          // in my room (client.roomId === ws.roomId)\r\n          // without me (client !== ws)\r\n        });\r\n      });\r\n    } else if (req.url === \"/videoIndex\") {\r\n      ws.location = \"videoIndex\";\r\n      ws.send(JSON.stringify(app.get(\"dummyDb2\").rooms));\r\n    } else if (req.url.startsWith(\"/video/\")) {\r\n      ws.location = req.url.split(\"/\")[2];\r\n      console.log(\"socket >>> ws.location : \" + ws.location);\r\n      ws.on(\"message\", (message) => {\r\n        // send message to open sockets in my room without me\r\n        //클라이언트가 현재 메시지를 보낸 클라이언트(ws)와 같지 않고,\r\n        //상태가 OPEN인 경우, 그리고 같은 방(location)에 있는 경우에만 메세지 전송\r\n        wss.clients.forEach((client) => {\r\n          if (\r\n            client !== ws &&\r\n            client.readyState === ws.OPEN &&\r\n            client.location === ws.location\r\n          ) {\r\n            client.send(message.toString());\r\n          }\r\n          // send message to\r\n          // open sockets (client.readyState === ws.OPEN)\r\n          // in my room (client.roomId === ws.roomId)\r\n          // without me (client !== ws)\r\n        });\r\n      });\r\n    }\r\n\r\n    ws.on(\"createRoom\", (roomId, userA) => {\r\n      console.log(\"Joining Room(171) : \", roomId);\r\n      ws.to(roomId).send(\"userConnected\", roomId, userA);\r\n    });\r\n\r\n    ws.on(\"error\", (error) => {\r\n      console.error(error);\r\n      app.locals.message = error.message;\r\n      app.locals.error = process.env.NODE_ENV !== \" production\" ? error : {};\r\n      app.render(\"error\");\r\n    });\r\n\r\n    ws.on(\"close\", () => console.log(`${req.url} connection close`));\r\n  });\r\n};\r\n"],"mappings":"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"}},"mtime":1706247641460}}